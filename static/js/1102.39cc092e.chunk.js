"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1102],{1102:(e,t,n)=>{n.r(t),n.d(t,{default:()=>B});var r=n(6399),i=n(6909),s=n(3504),l=n(6553),o=n(6658),a=n(8105),d=n(6317),c=n(6051),p=n(2019),u=n(4717),f=n(6651),x=n(5043),h=n(7285),y=n(4625),m=n(3805),g=n(7807),v=n(6291);var j=n(6881),A=n(3847),S=n(9316),b=n(8065),k=n.n(b),w=n(5109),O=n(8933),T=n.n(O),z=n(4462),D=n.n(z),C=n(4923),M=n(579);k().extend(T()),k().extend(D());const Y="#1976d2",P="#ff9800",W="#ede7f6",$={color:"#6c38a1",fontWeight:500,textDecoration:"underline",transition:"color 0.15s"},F="#4b256e";function E(e,t){return e.length>t?e.slice(0,t-1)+"\u2026":e}function H(e){const t=e.match(/(\d{2})\.(\d{2})\.(\d{4}).*?(\d{2}):(\d{2})/);if(t){const[e,n,r,i,s,l]=t;return`${i}-${r}-${n}T${s}:${l}`}}function I(e){var t,n;const{event:r}=e,i=null===(t=r.extendedProps)||void 0===t?void 0:t.isEducation,s=null===(n=r.extendedProps)||void 0===n?void 0:n.isCourse;return i?(0,M.jsx)(f.A,{title:(0,M.jsxs)("div",{style:{minWidth:220},children:[(0,M.jsx)("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:r.title}),(0,M.jsx)("div",{style:{color:"#888",fontSize:13},children:r.extendedProps.dateText||r.extendedProps.dateTime||r.startStr}),r.extendedProps.place&&(0,M.jsx)("div",{style:{color:"#1976d2",fontSize:13,margin:"4px 0"},children:r.extendedProps.place}),r.extendedProps.description&&(0,M.jsx)("div",{style:{fontSize:13,margin:"4px 0"},children:r.extendedProps.description}),r.extendedProps.link&&(0,M.jsx)("a",{href:r.extendedProps.link,target:"_blank",rel:"noopener noreferrer",style:{color:"#7c3aed",fontWeight:600,opacity:.8},children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"})]}),children:(0,M.jsx)("span",{style:{background:s?"#e0f7fa":W,color:"#333",fontWeight:500,maxWidth:110,display:"inline-block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:14,padding:"0 2px",borderRadius:6,transition:"color 0.15s"},children:r.title})}):(0,M.jsx)("span",{children:E(r.title,22)})}const B=()=>{const[e,t]=(0,x.useState)([]),[n,f]=(0,x.useState)(!0),[b,O]=(0,x.useState)(!1),[T,z]=(0,x.useState)(null),[D]=u.A.useForm(),[B,G]=(0,x.useState)("personal"),[q,R]=(0,x.useState)(k()()),V=(0,x.useRef)(null);(0,x.useEffect)(()=>{_()},[]),(0,x.useEffect)(()=>{if(V.current&&V.current.getApi){const e=V.current.getApi();e&&R(k()(e.getDate()))}},[]);const _=async()=>{f(!0);const e=await async function(){return(await v.Ay.get("/api/calendar")).data}();t(e),f(!1)};function K(e){const t=new Set;return e.filter(e=>{const n=`${e.title.trim()}|${k()(e.start).toISOString()}`;return!t.has(n)&&(t.add(n),!0)})}const L=async()=>{try{const e=await D.validateFields();console.log("values",e);const t={...e,start:e.start.format("YYYY-MM-DDTHH:mm:ss"),end:e.end?e.end.format("YYYY-MM-DDTHH:mm:ss"):void 0,type:e.type||"personal"};console.log("payload",t),T?await async function(e,t){return(await v.Ay.put(`/calendar/${e}`,t)).data}(T.id,t):await async function(e){return(await v.Ay.post("/api/calendar",e)).data}(t),O(!1),D.resetFields(),_()}catch(n){var e,t;p.Ay.error((null===n||void 0===n||null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||n.message||"\u041e\u0448\u0438\u0431\u043a\u0430")}},N=(0,x.useMemo)(()=>{const e=q.startOf("month").startOf("day"),t=q.endOf("month").endOf("day");return w.educationEvents.filter(n=>{const r=k()(n.startDate).startOf("day"),i=n.endDate?k()(n.endDate).endOf("day"):r;return r.isSameOrBefore(t)&&i.isSameOrAfter(e)})},[q,w.educationEvents]),J=(0,x.useMemo)(()=>{const e=q.startOf("month").startOf("day"),t=q.endOf("month").endOf("day");return C.filter(n=>{const r=k()(H(n.dateTime)).startOf("day");return r.isSameOrBefore(t)&&r.isSameOrAfter(e)})},[q,C]);return(0,M.jsxs)("div",{style:{padding:32,background:"var(--background-color)",minHeight:"100vh"},children:[(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:24},children:[(0,M.jsxs)(c.A,{children:[(0,M.jsx)(j.A,{style:{fontSize:32,color:"#1976d2"}}),(0,M.jsx)("span",{style:{fontSize:28,fontWeight:700},children:"\u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u0439"})]}),(0,M.jsx)(d.Ay,{type:"primary",icon:(0,M.jsx)(A.A,{}),size:"large",onClick:()=>{z(null),O(!0),setTimeout(()=>{D.resetFields()},0)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u0435"})]}),(0,M.jsx)(a.A,{activeKey:B,onChange:e=>G(e),items:[{key:"personal",label:"\u041c\u043e\u0438 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f"},{key:"public",label:"\u0412\u0441\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"}],style:{marginBottom:24}}),(0,M.jsx)(h.A,{ref:V,plugins:[y.A,m.A,g.Ay],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},events:function(){const t=K(e).filter(e=>"personal"===B?"personal"===e.type:"public"===e.type).map(e=>({...e,id:e.id.toString()}));if("public"===B){const e=w.educationEvents.map((e,t)=>({id:`edu-${t}`,title:e.title,start:e.startDate,end:e.endDate,backgroundColor:W,borderColor:W,extendedProps:{...e,isEducation:!0}})),n=C.map((e,t)=>({id:`course-${t}`,title:e.title,start:H(e.dateTime),end:void 0,backgroundColor:"#e0f7fa",borderColor:"#e0f7fa",extendedProps:{...e,isEducation:!0,isCourse:!0}}));return[...t,...e,...n]}return t}().map(e=>{const t=e.extendedProps&&e.extendedProps.isEducation;return{...e,title:t?e.title:E(e.title,30)}}),selectable:!0,select:e=>{z(null),O(!0),setTimeout(()=>{D.resetFields(),D.setFieldsValue({start:k()(e.startStr),end:k()(e.endStr),type:"personal"})},0)},eventClick:t=>{const n=e.find(e=>e.id===Number(t.event.id));n&&(z(n),D.setFieldsValue({...n,start:k()(n.start),end:n.end?k()(n.end):void 0}),O(!0))},height:"auto",eventContent:I,locale:"ru",datesSet:e=>R(k()(e.view.currentStart))}),"public"===B&&N.length>0&&(0,M.jsxs)("div",{style:{marginTop:32,background:"var(--card-background)",borderRadius:14,boxShadow:"0 2px 12px #e6eaf1",padding:24},children:[(0,M.jsx)("div",{style:{fontWeight:700,fontSize:18,marginBottom:16},children:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f \u044d\u0442\u043e\u0433\u043e \u043c\u0435\u0441\u044f\u0446\u0430"}),(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:14},children:N.map((e,t)=>(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,M.jsx)(j.A,{style:{color:W,fontSize:22}}),(0,M.jsxs)("div",{style:{flex:1},children:[(0,M.jsx)("div",{style:{fontWeight:600,fontSize:16},children:e.title}),(0,M.jsx)("div",{style:{color:"#888",fontSize:14},children:e.dateText||e.startDate}),e.place&&(0,M.jsx)("div",{style:{color:"#1976d2",fontSize:14},children:e.place})]}),e.link&&(0,M.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",style:$,onMouseOver:e=>e.currentTarget.style.color=F,onMouseOut:e=>e.currentTarget.style.color=$.color,children:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"})]},t))}),J.length>0&&(0,M.jsxs)("div",{style:{marginTop:32},children:[(0,M.jsx)("div",{style:{fontWeight:700,fontSize:18,marginBottom:16},children:"\u0412\u0435\u0431\u0438\u043d\u0430\u0440\u044b \u044d\u0442\u043e\u0433\u043e \u043c\u0435\u0441\u044f\u0446\u0430"}),(0,M.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:14},children:J.map((e,t)=>(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:16},children:[(0,M.jsx)(j.A,{style:{color:"#e0f7fa",fontSize:22}}),(0,M.jsxs)("div",{style:{flex:1},children:[(0,M.jsx)("div",{style:{fontWeight:600,fontSize:16},children:e.title}),(0,M.jsx)("div",{style:{color:"#888",fontSize:14},children:e.dateTime})]}),e.link&&(0,M.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",style:$,onMouseOver:e=>e.currentTarget.style.color=F,onMouseOut:e=>e.currentTarget.style.color=$.color,children:"\u0421\u043c\u043e\u0442\u0440\u0435\u0442\u044c"})]},t))})]})]}),(0,M.jsx)(i.A,{open:b,onCancel:()=>{O(!1),D.resetFields()},onOk:L,title:T?"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043e\u0431\u044b\u0442\u0438\u0435":"\u041d\u043e\u0432\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435",okText:T?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",footer:[T&&(0,M.jsx)(d.Ay,{danger:!0,icon:(0,M.jsx)(S.A,{}),onClick:async()=>{if(T)try{await async function(e){await v.Ay.delete(`/calendar/${e}`)}(T.id),O(!1),D.resetFields(),_()}catch(n){var e,t;p.Ay.error((null===n||void 0===n||null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||n.message||"\u041e\u0448\u0438\u0431\u043a\u0430")}},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"},"delete"),(0,M.jsx)(d.Ay,{onClick:()=>{O(!1),D.resetFields()},children:"\u041e\u0442\u043c\u0435\u043d\u0430"},"cancel"),(0,M.jsx)(d.Ay,{type:"primary",onClick:L,children:T?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"},"ok")],destroyOnClose:!0,children:(0,M.jsxs)(u.A,{form:D,layout:"vertical",children:[(0,M.jsx)(u.A.Item,{name:"title",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}],children:(0,M.jsx)(o.A,{placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f"})}),(0,M.jsx)(u.A.Item,{name:"description",label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:(0,M.jsx)(o.A.TextArea,{placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u044f",autoSize:!0})}),(0,M.jsx)(u.A.Item,{name:"type",label:"\u0422\u0438\u043f",rules:[{required:!0}],children:(0,M.jsxs)(l.A,{children:[(0,M.jsx)(l.A.Option,{value:"personal",children:"\u041b\u0438\u0447\u043d\u043e\u0435"}),(0,M.jsx)(l.A.Option,{value:"public",children:"\u041e\u0431\u0449\u0435\u0435"})]})}),(0,M.jsx)(u.A.Item,{name:"start",label:"\u041d\u0430\u0447\u0430\u043b\u043e",rules:[{required:!0,message:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0438 \u0432\u0440\u0435\u043c\u044f"}],children:(0,M.jsx)(s.A,{showTime:!0,format:"YYYY-MM-DD HH:mm",style:{width:"100%"}})}),(0,M.jsx)(u.A.Item,{name:"end",label:"\u041e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u0435",children:(0,M.jsx)(s.A,{showTime:!0,format:"YYYY-MM-DD HH:mm",style:{width:"100%"}})})]})}),(0,M.jsxs)("div",{style:{marginTop:32},children:[(0,M.jsx)(r.A,{color:Y,style:{fontSize:16,padding:"4px 12px"},children:"\u041b\u0438\u0447\u043d\u043e\u0435 \u0441\u043e\u0431\u044b\u0442\u0438\u0435"}),(0,M.jsx)(r.A,{color:P,style:{fontSize:16,padding:"4px 12px",marginLeft:12},children:"\u041e\u0431\u0449\u0435\u0435 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435"})]}),(0,M.jsx)("style",{children:"\n        @media (max-width: 767px) {\n          .calendar-main {\n            flex-direction: column !important;\n            gap: 16px !important;\n            padding: 12px !important;\n          }\n          .ant-btn, .ant-input, .ant-select {\n            font-size: 18px !important;\n            height: 48px !important;\n          }\n        }\n      "})]})}}}]);
//# sourceMappingURL=1102.39cc092e.chunk.js.map