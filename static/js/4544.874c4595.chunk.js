/*! For license information please see 4544.874c4595.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4544],{1493:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(5043),o=n(579);const s=[55.751244,37.618423],a=11,i=e=>{let{properties:t,selectedId:n,onSelect:i,initialCenter:l=s,initialZoom:c=a,style:d={height:400,width:"100%"},onBoundsChange:u}=e;const p=(0,r.useRef)(null),f=(0,r.useRef)(null),h=(0,r.useRef)(null),g=(0,r.useRef)([]),m=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{if(!p.current)return;if(f.current)return;const e=()=>{f.current=new window.ymaps.Map(p.current,{center:l,zoom:c,controls:["zoomControl","fullscreenControl"]}),u&&f.current.events.add("boundschange",()=>{if(m.current)return void(m.current=!1);const e=f.current.getBounds();if(e&&e[0]&&e[1]){const[t,n]=e;u([t[1],t[0],n[1],n[0]])}})};window.ymaps&&window.ymaps.Map?e():window.ymaps.ready(e)},[l,c,u]),(0,r.useEffect)(()=>{if(!f.current||!window.ymaps)return;h.current&&(f.current.geoObjects.remove(h.current),h.current=null),g.current=[];const e=t.filter(e=>!isNaN(Number(e.lat))&&!isNaN(Number(e.lng))).map(e=>{let t=Array.isArray(e.photos)&&e.photos.length>0?e.photos[0]:"string"===typeof e.photos&&e.photos?JSON.parse(e.photos)[0]:null;t||(t="/placeholder-property.jpg");const r=`\n        <div style='width:180px'>\n          <img src='${t}' alt='\u0424\u043e\u0442\u043e' style='width:100%;height:90px;object-fit:cover;border-radius:8px;margin-bottom:6px;' onerror="this.src='/placeholder-property.jpg'" loading='lazy' />\n          <b>${e.title}</b><br/>\n          ${e.address}<br/>\n          <a href='/properties/${e.id}'>\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435</a>\n        </div>\n      `,o=new window.ymaps.Placemark([Number(e.lat),Number(e.lng)],{balloonContent:r},{preset:n===e.id?"islands#redIcon":"islands#blueIcon",iconColor:n===e.id?"#ff3333":"#3388ff"});return o.events.add("click",()=>{m.current=!0,i&&i(e.id)}),g.current.push(o),o});h.current=new window.ymaps.Clusterer({preset:"islands#invertedBlueClusterIcons",groupByCoordinates:!1,clusterDisableClickZoom:!1}),h.current.add(e),f.current.geoObjects.add(h.current)},[t,n,i]),(0,r.useEffect)(()=>{window.ymaps&&g.current.length&&g.current.forEach(e=>{var t;const r=null===(t=e.properties.get("balloonContent").match(/properties\/(\d+)/))||void 0===t?void 0:t[1];r&&(Number(r)===n?(e.options.set("preset","islands#redIcon"),e.options.set("iconColor","#ff3333")):(e.options.set("preset","islands#blueIcon"),e.options.set("iconColor","#3388ff")))})},[n]),(0,r.useEffect)(()=>{if(!f.current||!n)return;const e=t.find(e=>e.id===n&&!isNaN(Number(e.lat))&&!isNaN(Number(e.lng)));e&&f.current.setCenter([Number(e.lat),Number(e.lng)],f.current.getZoom(),{duration:300})},[n,t]),(0,r.useEffect)(()=>{f.current&&l&&f.current.setCenter(l,f.current.getZoom(),{duration:300})},[l]),(0,o.jsx)("div",{ref:p,style:d})}},3722:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(5043);const o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"};var s=n(3889);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}const i=(e,t)=>r.createElement(s.A,a({},e,{ref:t,icon:o}));const l=r.forwardRef(i)},3796:(e,t,n)=>{n.d(t,{A:()=>r});const r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"}},7534:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(5043);const o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M877.1 238.7L770.6 132.3c-13-13-30.4-20.3-48.8-20.3s-35.8 7.2-48.8 20.3L558.3 246.8c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l89.6 89.7a405.46 405.46 0 01-86.4 127.3c-36.7 36.9-79.6 66-127.2 86.6l-89.6-89.7c-13-13-30.4-20.3-48.8-20.3a68.2 68.2 0 00-48.8 20.3L132.3 673c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l106.4 106.4c22.2 22.2 52.8 34.9 84.2 34.9 6.5 0 12.8-.5 19.2-1.6 132.4-21.8 263.8-92.3 369.9-198.3C818 606 888.4 474.6 910.4 342.1c6.3-37.6-6.3-76.3-33.3-103.4zm-37.6 91.5c-19.5 117.9-82.9 235.5-178.4 331s-213 158.9-330.9 178.4c-14.8 2.5-30-2.5-40.8-13.2L184.9 721.9 295.7 611l119.8 120 .9.9 21.6-8a481.29 481.29 0 00285.7-285.8l8-21.6-120.8-120.7 110.8-110.9 104.5 104.5c10.8 10.8 15.8 26 13.3 40.8z"}}]},name:"phone",theme:"outlined"};var s=n(3889);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}const i=(e,t)=>r.createElement(s.A,a({},e,{ref:t,icon:o}));const l=r.forwardRef(i)},7575:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var r=n(6909),o=n(5964),s=n(1686),a=n(6553),i=n(585),l=n(6658),c=n(6317),d=n(5043),u=n(1493),p=n(1283),f=n(7534);const h={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"};var g=n(3889);function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}const b=(e,t)=>d.createElement(g.A,m({},e,{ref:t,icon:h}));const v=d.forwardRef(b);var y=n(3722),x=n(6625),w=n(6886),j=n(3259),A=n(5554),C=n(6948),N=n(579);const S=[{value:"for_sale",label:"\u0412 \u043f\u0440\u043e\u0434\u0430\u0436\u0435"},{value:"in_deal",label:"\u041d\u0430 \u0437\u0430\u0434\u0430\u0442\u043a\u0435"},{value:"reserved",label:"\u041d\u0430 \u0431\u0440\u043e\u043d\u0438"},{value:"sold",label:"\u041f\u0440\u043e\u0434\u0430\u043d"}],O=[{value:"apartment",label:"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"},{value:"house",label:"\u0414\u043e\u043c"},{value:"commercial",label:"\u041a\u043e\u043c\u043c\u0435\u0440\u0446\u0438\u044f"},{value:"land",label:"\u0423\u0447\u0430\u0441\u0442\u043e\u043a"}];function z(){const e=(0,p.zy)(),t=(0,p.Zp)(),{isClientMode:n}=(d.useContext(x.cy),(0,j.Q)()),{filters:h,updateFilters:g,resetFilters:m,bbox:b,setBbox:z,properties:k,loading:R,selectedId:I,setSelectedId:E,center:B,setCenter:P}=(0,w.w)(),[M,L]=d.useState("archive"===new URLSearchParams(e.search).get("tab")?"archive":"active"),[T,W]=d.useState(!1),[H,Z]=(0,p.ok)(),D=d.useRef(!1),[$,F]=d.useState(!1),J=d.useRef(null),U=d.useRef(null),[V,X]=(0,d.useState)(!0),[_,Q]=(0,d.useState)(null),[Y,q]=(0,d.useState)(null),G=d.useRef({});d.useEffect(()=>{setTimeout(()=>W(!0),10)},[]),d.useEffect(()=>{if(D.current)return;D.current=!0;const e=H.get("bbox"),t=H.get("selectedId"),n=H.get("filters");if(e){const t=e.split(",").map(Number);4===t.length&&t.every(e=>!isNaN(e))&&z(t)}if(t&&E(Number(t)),n)try{const e=JSON.parse(decodeURIComponent(n));g(e)}catch{}},[H,z,E,g]),d.useEffect(()=>{const e={};b&&(e.bbox=b.join(",")),I&&(e.selectedId=I),Object.keys(h).length>0&&(e.filters=encodeURIComponent(JSON.stringify(h))),Z(e)},[b,I,h]);let K=k.filter(e=>"active"===M?"sold"!==e.status:"sold"===e.status);b&&Array.isArray(b)&&4===b.length&&(K=K.filter(e=>{if("number"!==typeof e.lat||"number"!==typeof e.lng)return!1;const[t,n,r,o]=b;return e.lat>=n&&e.lat<=o&&e.lng>=t&&e.lng<=r}));d.useEffect(()=>(R?J.current=setTimeout(()=>{F(!0),U.current=setTimeout(()=>{},400)},250):(J.current&&clearTimeout(J.current),$&&(U.current?(setTimeout(()=>F(!1),400),clearTimeout(U.current)):F(!1))),()=>{J.current&&clearTimeout(J.current),U.current&&clearTimeout(U.current)}),[R]);const ee=!b||b&&Math.abs(b[2]-b[0])>.5&&Math.abs(b[3]-b[1])>.5?K:K.slice(0,300),te=ee.length>300;return d.useEffect(()=>{var e;I&&G.current[I]&&(null===(e=G.current[I])||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"}))},[I]),(0,N.jsxs)("div",{className:"big-map-page"+(T?" big-map-page--show":""),style:{display:"flex",height:"calc(100vh - 80px)",position:"relative",transition:"background 0.5s"},children:[(0,N.jsxs)("div",{style:{width:340,overflowY:"auto",background:"#fff",borderRight:"1px solid #eee",padding:8,display:"flex",flexDirection:"column",transition:"transform 0.5s",transform:T?"translateX(0)":"translateX(-100%)",opacity:T?1:0},children:[(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:300},children:[(0,N.jsx)(c.Ay,{type:"default",size:"small",style:{marginBottom:8},onClick:()=>X(e=>!e),children:V?"\u0421\u043a\u0440\u044b\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b":"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"}),(0,N.jsx)("div",{style:{transition:"max-height 0.3s, opacity 0.3s",overflow:"hidden",maxHeight:V?400:0,opacity:V?1:0},children:(0,N.jsxs)("div",{style:{marginBottom:18,display:"flex",flexDirection:"column",gap:10},children:[(0,N.jsx)(l.A.Search,{placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u0430\u0434\u0440\u0435\u0441\u0443 \u0438\u043b\u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e...",value:h.search||"",onChange:e=>g({search:e.target.value}),allowClear:!0}),(0,N.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,N.jsx)(i.A,{placeholder:"\u0426\u0435\u043d\u0430 \u043e\u0442",min:0,value:h.minPrice,onChange:e=>g({minPrice:null===e?void 0:e}),style:{width:100}}),(0,N.jsx)(i.A,{placeholder:"\u0434\u043e",min:0,value:h.maxPrice,onChange:e=>g({maxPrice:null===e?void 0:e}),style:{width:100}}),(0,N.jsx)(i.A,{placeholder:"\u041f\u043b\u043e\u0449\u0430\u0434\u044c \u043e\u0442",min:0,value:h.minArea,onChange:e=>g({minArea:null===e?void 0:e}),style:{width:100}}),(0,N.jsx)(i.A,{placeholder:"\u0434\u043e",min:0,value:h.maxArea,onChange:e=>g({maxArea:null===e?void 0:e}),style:{width:100}})]}),(0,N.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,N.jsx)(a.A,{placeholder:"\u0421\u0442\u0430\u0442\u0443\u0441",allowClear:!0,value:h.status,onChange:e=>g({status:e}),options:S,style:{width:120}}),(0,N.jsx)(a.A,{placeholder:"\u0422\u0438\u043f",allowClear:!0,value:h.type,onChange:e=>g({type:e}),options:O,style:{width:120}})]}),(0,N.jsx)(c.Ay,{onClick:m,style:{borderRadius:8,fontWeight:500,marginTop:8},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c"})]})})]}),(0,N.jsxs)("div",{style:{background:"#fafbfc",padding:"8px 0",borderRadius:12,minHeight:400},children:[te&&(0,N.jsxs)("div",{style:{color:"#ff9800",fontWeight:500,textAlign:"center",marginBottom:12},children:["\u041f\u043e\u043a\u0430\u0437\u0430\u043d\u044b \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0435\u0440\u0432\u044b\u0435 ",300," \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0434\u043b\u044f \u0443\u0441\u043a\u043e\u0440\u0435\u043d\u0438\u044f \u0440\u0430\u0431\u043e\u0442\u044b"]}),ee.map((e,t)=>(0,N.jsx)(d.Fragment,{children:(0,N.jsxs)("div",{ref:t=>{G.current[e.id]=t},style:{display:"flex",alignItems:"stretch",padding:"0 4px",width:"100%",maxWidth:"100%",marginBottom:8,background:e.id===I?"#e6f0ff":"transparent",borderRadius:10,boxShadow:e.id===I?"0 0 0 2px #1976d2":"none",transition:"background 0.2s, box-shadow 0.2s",position:"relative",cursor:"pointer",minHeight:72},onClick:()=>E(e.id),children:[(0,N.jsx)(C.A,{property:e,mode:"compact",showActions:!1,style:{fontSize:14,minHeight:60,padding:8}}),!n&&(0,N.jsx)(c.Ay,{type:"default",icon:(0,N.jsx)(f.A,{}),style:{position:"absolute",bottom:10,right:10,zIndex:2,borderRadius:8,fontWeight:600,height:32,width:32,minWidth:32,padding:0,fontSize:16},onClick:t=>{t.stopPropagation(),q({open:!0,agent:e.agent})}})]})},e.id))]})]}),(0,N.jsxs)("div",{style:{flex:1,transition:"all 0.5s",opacity:T?1:0,position:"relative"},children:[(0,N.jsx)(c.Ay,{type:"default",icon:(0,N.jsx)(v,{style:{fontSize:22}}),onClick:()=>t("/properties"),style:{position:"absolute",top:24,right:24,zIndex:1e3,background:"#fff",borderRadius:"50%",boxShadow:"0 2px 8px rgba(40,60,90,0.10)",width:48,height:48,display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u0441\u043f\u0438\u0441\u043a\u0443"}),$&&(0,N.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",zIndex:1001,transform:"translate(-50%, -50%)"},children:(0,N.jsx)(s.A,{size:"large"})}),(0,N.jsx)(u.A,{properties:K,selectedId:I,onSelect:E,initialCenter:B,initialZoom:12,onBoundsChange:e=>{z(e)},style:{height:"100%",width:"100%"}})]}),(0,N.jsx)(A.A,{open:!!_,propertyId:_||void 0,onClose:()=>Q(null)}),!n&&(0,N.jsx)(r.A,{open:!(null===Y||void 0===Y||!Y.open),onCancel:()=>q(null),footer:null,title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431 \u0430\u0433\u0435\u043d\u0442\u0435",children:null!==Y&&void 0!==Y&&Y.agent?(0,N.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:18},children:[(0,N.jsx)(o.A,{size:64,src:Y.agent.photo,icon:(0,N.jsx)(y.A,{})}),(0,N.jsxs)("div",{children:[(0,N.jsxs)("div",{style:{fontWeight:700,fontSize:18},children:[Y.agent.firstName," ",Y.agent.lastName]}),(0,N.jsxs)("div",{style:{color:"#1976d2",fontSize:17,margin:"4px 0",fontWeight:500},children:[(0,N.jsx)(f.A,{})," ",Y.agent.phone]}),(0,N.jsx)("div",{style:{color:"#888",fontSize:15},children:Y.agent.email||"\u2014"})]})]}):(0,N.jsx)("div",{children:"\u041d\u0435\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e\u0431 \u0430\u0433\u0435\u043d\u0442\u0435"})}),(0,N.jsx)("style",{children:"\n        .big-map-page {\n          background: #f8fafc;\n        }\n        .big-map-page--show {\n          background: #e9f0fb;\n        }\n        @media (max-width: 767px) {\n          .map-filters {\n            flex-direction: column !important;\n            gap: 8px !important;\n            padding: 12px !important;\n          }\n          .ant-btn, .ant-input, .ant-select {\n            font-size: 18px !important;\n            height: 48px !important;\n          }\n        }\n      "})]})}},7725:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(5043),o=n(3796),s=n(3889);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}const i=(e,t)=>r.createElement(s.A,a({},e,{ref:t,icon:o.A}));const l=r.forwardRef(i)},8058:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(5043),o=n(8181),s=n(3889);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}const i=(e,t)=>r.createElement(s.A,a({},e,{ref:t,icon:o.A}));const l=r.forwardRef(i)},8181:(e,t,n)=>{n.d(t,{A:()=>r});const r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"}}}]);
//# sourceMappingURL=4544.874c4595.chunk.js.map