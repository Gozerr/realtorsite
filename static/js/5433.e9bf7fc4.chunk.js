"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5433],{3560:(e,s,t)=>{t.d(s,{E:()=>l});var r=t(5043),n=t(6625),i=t(6291),a=t(2104);const l=()=>{const{user:e}=(0,n.As)(),[s,t]=(0,r.useState)({total:0,chat:0,support:0,property:0,system:0}),[l,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(new Set),h=async()=>{if(null!==e&&void 0!==e&&e.id)try{o(!0);const s=await i.Ay.get(`/api/notifications/counters/${e.id}`);t(s.data)}catch(s){console.error("Error fetching notification counters:",s)}finally{o(!1)}},p=(e,s,r)=>{t(t=>{const n={...t};switch(e){case"chat":"increment"===s?n.chat++:"decrement"===s?n.chat=void 0!==r?Math.max(0,n.chat-r):Math.max(0,n.chat-1):"set"===s&&void 0!==r&&(n.chat=r);break;case"support":"increment"===s?n.support++:"decrement"===s?n.support=void 0!==r?Math.max(0,n.support-r):Math.max(0,n.support-1):"set"===s&&void 0!==r&&(n.support=r);break;case"property":"increment"===s?n.property++:"decrement"===s?n.property=void 0!==r?Math.max(0,n.property-r):Math.max(0,n.property-1):"set"===s&&void 0!==r&&(n.property=r);break;case"system":"increment"===s?n.system++:"decrement"===s?n.system=void 0!==r?Math.max(0,n.system-r):Math.max(0,n.system-1):"set"===s&&void 0!==r&&(n.system=r)}return n.total=n.chat+n.support+n.property+n.system,n})};return(0,r.useEffect)(()=>{h();const e=(0,a.io)("http://localhost:3001",{transports:["websocket"]});e.on("connect",()=>{console.log("Notifications hook connected to WebSocket")}),e.on("notification",e=>{"chat_message"!==e.type&&"chat"!==e.category||(console.log("New chat message notification received"),p("chat","increment")),"support_request"!==e.type&&"support"!==e.category||(console.log("New support request notification received"),p("support","increment")),"support_resolved"===e.type&&(console.log("Support request resolved notification received"),p("support","decrement")),"support_closed"===e.type&&(console.log("Support request closed notification received"),p("support","decrement"))});const s=setInterval(h,3e4);return()=>{e.disconnect(),clearInterval(s)}},[null===e||void 0===e?void 0:e.id]),{counters:s,loading:l,fetchCounters:h,markAsRead:async s=>{if(null!==e&&void 0!==e&&e.id)try{const t=s?`/api/notifications/mark-read/${e.id}/${s}`:`/api/notifications/mark-read/${e.id}`;await i.Ay.patch(t),await h()}catch(t){console.error("Error marking notifications as read:",t)}},updateCounters:p,markAsViewed:e=>{const s=new Set(c);e.forEach(e=>s.add(e)),d(s)},isViewed:e=>c.has(e),clearViewedNotifications:()=>{d(new Set)}}}},5433:(e,s,t)=>{t.r(s),t.d(s,{default:()=>Z});var r=t(6263),n=t(4522),i=t(8354),a=t(5964),l=t(6909),o=t(7490),c=t(7419),d=t(1645),h=t(9073),p=t(6612),x=t(9607),u=t(6051),j=t(6317),y=t(6399),m=t(2019),g=t(4717),A=t(8105),v=t(6658),f=t(5297),w=t(5043),S=t(5229),k=t(6237),b=t(9967),C=t(7534),N=t(3117),I=t(4786),z=t(6270),F=t(617),T=t(6091),q=t(6011),$=t(3722),_=t(9470),E=t(9145),D=t(3560),L=t(2104),R=t(579);const{Title:U,Text:W}=f.A,{TextArea:B}=v.A,{TabPane:M}=A.A,Z=()=>{var e,s,t,v,f;const[Z,P]=(0,w.useState)([]),[V,K]=(0,w.useState)([]),[J,Q]=(0,w.useState)({}),[X,H]=(0,w.useState)(!1),[G,O]=(0,w.useState)(!1),[Y,ee]=(0,w.useState)(null),[se]=g.A.useForm(),{updateCounters:te}=(0,D.E)(),[re,ne]=(0,w.useState)(!1),[ie,ae]=(0,w.useState)(null),[le,oe]=(0,w.useState)(!1),[ce,de]=(0,w.useState)([]),[he,pe]=(0,w.useState)(!1),[xe,ue]=(0,w.useState)([]),[je,ye]=(0,w.useState)([]),[me,ge]=(0,w.useState)(!1),[Ae,ve]=(0,w.useState)(null),[fe,we]=(0,w.useState)(!1),[Se]=g.A.useForm(),[ke,be]=(0,w.useState)(new Set),[Ce,Ne]=(0,w.useState)(new Set);(0,w.useEffect)(()=>{Ie();const e=(0,L.io)("http://localhost:3001",{transports:["websocket"]});e.on("connect",()=>{console.log("Support dashboard connected to WebSocket")}),e.on("notification",e=>{"support_request"!==e.type&&"support"!==e.category||(console.log("New support request received, refreshing data..."),Ie(),m.Ay.info("\u041f\u043e\u0441\u0442\u0443\u043f\u0438\u043b \u043d\u043e\u0432\u044b\u0439 \u0437\u0430\u043f\u0440\u043e\u0441 \u0432 \u0441\u043b\u0443\u0436\u0431\u0443 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438")),"support_resolved"!==e.type&&"support_closed"!==e.type||(console.log("Support request status changed, refreshing data..."),Ie())});const s=setInterval(()=>{Ie()},3e4);return()=>{e.disconnect(),clearInterval(s)}},[]);const Ie=async()=>{H(!0);try{const[e,s,t]=await Promise.all([(0,E._C)(),(0,E.Vo)(),(0,E.tX)()]),r=e.filter(e=>"closed"!==e.status),n=e.filter(e=>"closed"===e.status);P(r),K(n),Q(s),ye(t)}catch(e){m.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445")}finally{H(!1)}},ze=Z.filter(e=>!ke.has(e.id)).length,Fe=V.filter(e=>!Ce.has(e.id)).length,Te=[{title:"\u0421\u0442\u0430\u0442\u0443\u0441",dataIndex:"status",key:"status",render:e=>(e=>{switch(e){case"pending":return(0,R.jsx)(y.A,{color:"orange",icon:(0,R.jsx)(S.A,{}),children:"\u041e\u0436\u0438\u0434\u0430\u0435\u0442"});case"in_progress":return(0,R.jsx)(y.A,{color:"blue",icon:(0,R.jsx)(S.A,{}),children:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435"});case"resolved":return(0,R.jsx)(y.A,{color:"green",icon:(0,R.jsx)(k.A,{}),children:"\u0420\u0435\u0448\u0435\u043d\u043e"});case"closed":return(0,R.jsx)(y.A,{color:"red",icon:(0,R.jsx)(b.A,{}),children:"\u0417\u0430\u043a\u0440\u044b\u0442\u043e"});default:return(0,R.jsx)(y.A,{children:e})}})(e),width:120},{title:"\u041a\u043b\u0438\u0435\u043d\u0442",key:"client",render:e=>(0,R.jsxs)("div",{children:[(0,R.jsx)("div",{children:(0,R.jsxs)("strong",{children:[e.lastName," ",e.firstName," ",e.middleName]})}),(0,R.jsxs)("div",{style:{color:"#666",fontSize:"12px"},children:[(0,R.jsx)(C.A,{})," ",e.phone]})]})},{title:"\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u0430",dataIndex:"problem",key:"problem",render:(e,s)=>(0,R.jsx)("div",{style:{maxWidth:300},children:(0,R.jsx)(W,{ellipsis:{tooltip:e},style:{cursor:"pointer",color:"#1890ff"},onClick:()=>(e=>{ee(e),O(!0)})(s),children:e})})},{title:"\u0414\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f",dataIndex:"createdAt",key:"createdAt",render:e=>new Date(e).toLocaleString("ru-RU"),width:150},{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f",key:"actions",render:e=>(0,R.jsxs)(u.A,{children:["pending"===e.status&&(0,R.jsx)(j.Ay,{type:"primary",size:"small",onClick:()=>(async e=>{try{await(0,E.g1)(e),m.Ay.success("\u0417\u0430\u043f\u0440\u043e\u0441 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d \u0432\u0430\u043c"),Ie()}catch(s){m.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430")}})(e.id),children:"\u0412\u0437\u044f\u0442\u044c \u0432 \u0440\u0430\u0431\u043e\u0442\u0443"}),"in_progress"===e.status&&(0,R.jsx)(j.Ay,{type:"primary",size:"small",icon:(0,R.jsx)(N.A,{}),onClick:()=>{ee(e),O(!0)},children:"\u0420\u0435\u0448\u0438\u0442\u044c"}),"resolved"===e.status&&(0,R.jsx)(j.Ay,{type:"default",size:"small",onClick:()=>(async e=>{try{await(0,E.x7)(e),m.Ay.success("\u0417\u0430\u043f\u0440\u043e\u0441 \u0437\u0430\u043a\u0440\u044b\u0442"),Ie()}catch(s){m.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430")}})(e.id),children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),(0,R.jsx)(j.Ay,{type:"default",size:"small",icon:(0,R.jsx)(I.A,{}),onClick:()=>(async()=>{try{ae({id:1,firstName:"\u0418\u0432\u0430\u043d",lastName:"\u0418\u0432\u0430\u043d\u043e\u0432",middleName:"\u0418\u0432\u0430\u043d\u043e\u0432\u0438\u0447",email:"ivan@example.com",phone:"+7 (999) 123-45-67",telegramUsername:"@ivan_ivanov",whatsappNumber:"+7 (999) 123-45-67",agency:'\u041e\u041e\u041e "\u0420\u0438\u044d\u043b\u0442-\u0421\u0435\u0440\u0432\u0438\u0441"',role:"agent",photo:"https://via.placeholder.com/150",createdAt:"2024-01-01T00:00:00Z",lastLoginAt:"2024-01-15T10:30:00Z",activeSessions:[{id:"session1",deviceInfo:"Chrome 120.0.0.0 on Windows 10",ipAddress:"192.168.1.100",lastActivity:"2024-01-15T10:30:00Z"}]}),ne(!0)}catch(e){m.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435")}})(),title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435"}),(0,R.jsx)(j.Ay,{type:"default",size:"small",icon:(0,R.jsx)(z.A,{}),onClick:()=>(async()=>{try{de([{id:1,action:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u043e\u0431\u044a\u0435\u043a\u0442\u0430",details:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u043b \u043e\u0431\u044a\u0435\u043a\u0442 \u043d\u0435\u0434\u0432\u0438\u0436\u0438\u043c\u043e\u0441\u0442\u0438 ID: 123",timestamp:"2024-01-15T10:30:00Z",severity:"info"},{id:2,action:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435",details:"\u041e\u0448\u0438\u0431\u043a\u0430 404 \u043f\u0440\u0438 \u043f\u043e\u043f\u044b\u0442\u043a\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430",timestamp:"2024-01-15T10:25:00Z",error:"Failed to load image: 404 Not Found",severity:"error"},{id:3,action:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438",details:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441\u043e\u0437\u0434\u0430\u043b \u0437\u0430\u043f\u0440\u043e\u0441 \u0432 \u0441\u043b\u0443\u0436\u0431\u0443 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438",timestamp:"2024-01-15T10:20:00Z",severity:"info"}]),oe(!0)}catch(e){m.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f")}})(),title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})]}),width:200}],qe=e=>(0,R.jsx)(x.A,{columns:Te,dataSource:e,rowKey:"id",loading:X,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0}}),$e=[{title:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",key:"user",render:e=>(0,R.jsxs)("div",{children:[(0,R.jsx)("div",{children:(0,R.jsxs)("strong",{children:[e.lastName," ",e.firstName," ",e.middleName]})}),(0,R.jsx)("div",{style:{color:"#666",fontSize:"12px"},children:e.email})]})},{title:"\u0420\u043e\u043b\u044c",dataIndex:"role",key:"role",render:e=>(0,R.jsx)(y.A,{color:"blue",children:{director:"\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440",agent:"\u0410\u0433\u0435\u043d\u0442",manager:"\u0420\u0443\u043a\u043e\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c",private_realtor:"\u0427\u0430\u0441\u0442\u043d\u044b\u0439 \u0440\u0438\u044d\u043b\u0442\u043e\u0440"}[e]||e})},{title:"\u0410\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e",key:"agency",render:e=>(0,R.jsx)("div",{children:e.agency?(0,R.jsxs)("div",{children:[(0,R.jsx)("div",{children:(0,R.jsx)("strong",{children:e.agency.name})}),e.agency.logo&&(0,R.jsx)("img",{src:e.agency.logo,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f",style:{width:30,height:30,objectFit:"cover",borderRadius:4}})]}):(0,R.jsx)("span",{style:{color:"#999"},children:"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e"})})},{title:"\u0414\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",dataIndex:"createdAt",key:"createdAt",render:e=>new Date(e).toLocaleString("ru-RU"),width:150},{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f",key:"actions",render:e=>(0,R.jsx)(u.A,{children:(0,R.jsx)(j.Ay,{type:"primary",size:"small",icon:(0,R.jsx)(I.A,{}),onClick:()=>(async e=>{try{const s=await(0,E.$D)(e.id);ve(s),ge(!0)}catch(s){m.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0435\u0442\u0430\u043b\u0435\u0439 \u0437\u0430\u044f\u0432\u043a\u0438")}})(e),children:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"})}),width:120}];return(0,R.jsxs)("div",{style:{padding:24},children:[(0,R.jsx)(U,{level:2,children:"\u041f\u0430\u043d\u0435\u043b\u044c \u0441\u043b\u0443\u0436\u0431\u044b \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438"}),(0,R.jsxs)(c.A,{gutter:16,style:{marginBottom:24},children:[(0,R.jsx)(d.A,{span:6,children:(0,R.jsx)(h.A,{children:(0,R.jsx)(p.A,{title:"\u0412\u0441\u0435\u0433\u043e \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432",value:J.total||0,valueStyle:{color:"#3f8600"}})})}),(0,R.jsx)(d.A,{span:6,children:(0,R.jsx)(h.A,{children:(0,R.jsx)(p.A,{title:"\u041e\u0436\u0438\u0434\u0430\u044e\u0442",value:J.pending||0,valueStyle:{color:"#faad14"}})})}),(0,R.jsx)(d.A,{span:6,children:(0,R.jsx)(h.A,{children:(0,R.jsx)(p.A,{title:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435",value:J.inProgress||0,valueStyle:{color:"#1890ff"}})})}),(0,R.jsx)(d.A,{span:6,children:(0,R.jsx)(h.A,{children:(0,R.jsx)(p.A,{title:"\u0420\u0435\u0448\u0435\u043d\u043e",value:J.resolved||0,valueStyle:{color:"#52c41a"}})})})]}),(0,R.jsx)(h.A,{title:(0,R.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,R.jsx)("span",{children:"\u0417\u0430\u043f\u0440\u043e\u0441\u044b \u0432 \u0441\u043b\u0443\u0436\u0431\u0443 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438"}),(0,R.jsx)(j.Ay,{icon:(0,R.jsx)(F.A,{}),onClick:()=>{Ie(),m.Ay.success("\u0414\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b")},loading:X,children:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"})]}),children:(0,R.jsxs)(A.A,{defaultActiveKey:"active",onChange:e=>{if("active"===e){const e=new Set(ke);Z.forEach(s=>e.add(s.id)),be(e);const s=Z.filter(e=>!ke.has(e.id)).length;s>0&&(te("support","decrement",s),m.Ay.info(`\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u043e ${s} \u043d\u043e\u0432\u044b\u0445 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432`))}else if("archived"===e){const e=new Set(Ce);V.forEach(s=>e.add(s.id)),Ne(e);const s=V.filter(e=>!Ce.has(e.id)).length;s>0&&(te("support","decrement",s),m.Ay.info(`\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u043e ${s} \u043d\u043e\u0432\u044b\u0445 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 \u0430\u0440\u0445\u0438\u0432\u0435`))}},children:[(0,R.jsx)(M,{tab:(0,R.jsxs)("span",{children:[(0,R.jsx)(N.A,{}),"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b",ze>0&&(0,R.jsx)(o.A,{count:ze,style:{marginLeft:8}})]}),children:qe(Z)},"active"),(0,R.jsx)(M,{tab:(0,R.jsxs)("span",{children:[(0,R.jsx)(T.A,{}),"\u0410\u0440\u0445\u0438\u0432",Fe>0&&(0,R.jsx)(o.A,{count:Fe,style:{marginLeft:8}})]}),children:qe(V)},"archived"),(0,R.jsx)(M,{tab:(0,R.jsxs)("span",{children:[(0,R.jsx)(q.A,{}),"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430",je.length>0&&(0,R.jsx)(o.A,{count:je.length,style:{marginLeft:8}})]}),children:(0,R.jsx)(x.A,{columns:$e,dataSource:je,rowKey:"id",loading:X,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0}})},"authorization")]})}),(0,R.jsx)(l.A,{title:"\u0420\u0435\u0448\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u0430",open:G,onCancel:()=>{O(!1),ee(null),se.resetFields()},footer:null,children:(0,R.jsxs)(g.A,{form:se,onFinish:async e=>{if(Y)try{await(0,E.PW)(Y.id,e.resolution),m.Ay.success("\u0417\u0430\u043f\u0440\u043e\u0441 \u043e\u0442\u043c\u0435\u0447\u0435\u043d \u043a\u0430\u043a \u0440\u0435\u0448\u0435\u043d\u043d\u044b\u0439"),O(!1),se.resetFields(),ee(null),Ie()}catch(s){m.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0448\u0435\u043d\u0438\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0430")}},layout:"vertical",children:[(0,R.jsx)(g.A.Item,{name:"resolution",label:"\u0420\u0435\u0448\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b"}],children:(0,R.jsx)(B,{rows:4,placeholder:"\u041e\u043f\u0438\u0448\u0438\u0442\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b..."})}),(0,R.jsx)(g.A.Item,{children:(0,R.jsxs)(u.A,{children:[(0,R.jsx)(j.Ay,{type:"primary",htmlType:"submit",children:"\u041e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u043a\u0430\u043a \u0440\u0435\u0448\u0435\u043d\u043d\u043e\u0435"}),(0,R.jsx)(j.Ay,{onClick:()=>{O(!1),ee(null),se.resetFields()},children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]})})]})}),(0,R.jsx)(l.A,{title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435",open:re,onCancel:()=>ne(!1),footer:null,width:600,children:ie&&(0,R.jsxs)("div",{children:[(0,R.jsxs)(c.A,{gutter:16,style:{marginBottom:16},children:[(0,R.jsx)(d.A,{span:8,children:(0,R.jsx)(a.A,{size:64,src:ie.photo,icon:(0,R.jsx)($.A,{})})}),(0,R.jsxs)(d.A,{span:16,children:[(0,R.jsxs)(U,{level:4,children:[ie.firstName," ",ie.lastName," ",ie.middleName]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"Email:"})," ",ie.email]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d:"})," ",ie.phone]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0420\u043e\u043b\u044c:"})," ",ie.role]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0410\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e:"})," ",ie.agency]})]})]}),(0,R.jsx)(i.A,{}),(0,R.jsx)(U,{level:5,children:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b"}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"Telegram:"})," ",ie.telegramUsername||"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"WhatsApp:"})," ",ie.whatsappNumber||"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"]}),(0,R.jsx)(i.A,{}),(0,R.jsx)(U,{level:5,children:"\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0441\u0435\u0441\u0441\u0438\u0438"}),ie.activeSessions&&ie.activeSessions.length>0?(0,R.jsx)(n.A,{dataSource:ie.activeSessions,renderItem:e=>(0,R.jsx)(n.A.Item,{children:(0,R.jsxs)("div",{children:[(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0423\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u043e:"})," ",e.deviceInfo]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"IP \u0430\u0434\u0440\u0435\u0441:"})," ",e.ipAddress]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c:"})," ",new Date(e.lastActivity).toLocaleString("ru-RU")]})]})})}):(0,R.jsx)("p",{children:"\u041d\u0435\u0442 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0445 \u0441\u0435\u0441\u0441\u0438\u0439"})]})}),(0,R.jsx)(l.A,{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",open:le,onCancel:()=>oe(!1),footer:null,width:800,children:(0,R.jsx)(r.A,{children:ce.map(e=>(0,R.jsxs)(r.A.Item,{color:"error"===e.severity?"red":"warning"===e.severity?"orange":"blue",children:[(0,R.jsx)("p",{children:(0,R.jsx)("strong",{children:e.action})}),(0,R.jsx)("p",{children:e.details}),e.error&&(0,R.jsx)("p",{style:{color:"#ff4d4f",fontFamily:"monospace"},children:e.error}),(0,R.jsx)("p",{style:{fontSize:"12px",color:"#666"},children:new Date(e.timestamp).toLocaleString("ru-RU")})]},e.id))})}),(0,R.jsx)(l.A,{title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0437\u0430\u044f\u0432\u043a\u0438 \u043d\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044e",open:me,onCancel:()=>ge(!1),footer:null,width:800,children:Ae&&(0,R.jsxs)("div",{children:[(0,R.jsxs)(c.A,{gutter:16,style:{marginBottom:16},children:[(0,R.jsxs)(d.A,{span:8,style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,R.jsxs)("div",{style:{marginBottom:8,textAlign:"center"},children:[Ae.user.photo?(0,R.jsx)("img",{src:Ae.user.photo,alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",style:{width:96,height:96,borderRadius:16,objectFit:"cover",marginBottom:4,border:"1px solid #eee"}}):(0,R.jsx)($.A,{style:{fontSize:96,color:"#ccc",marginBottom:4}}),(0,R.jsx)("div",{style:{fontSize:12,color:"#888"},children:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})]}),Ae.agency&&Ae.agency.logo&&(0,R.jsxs)("div",{style:{textAlign:"center"},children:[(0,R.jsx)(a.A,{size:64,src:Ae.agency.logo,style:{background:"#fff",border:"1px solid #eee",marginBottom:4},onError:()=>!1}),(0,R.jsx)("div",{style:{fontSize:12,color:"#888"},children:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430"})]})]}),(0,R.jsxs)(d.A,{span:16,children:[(0,R.jsxs)(U,{level:4,children:[Ae.user.firstName," ",Ae.user.lastName," ",Ae.user.middleName]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"Email:"})," ",Ae.user.email]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d:"})," ",Ae.user.phone]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0420\u043e\u043b\u044c:"})," ",Ae.user.role]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0414\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438:"})," ",new Date(Ae.user.createdAt).toLocaleString("ru-RU")]})]})]}),(0,R.jsx)(i.A,{}),(0,R.jsx)(U,{level:5,children:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b"}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"Telegram:"})," ",Ae.user.telegramUsername||"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"WhatsApp:"})," ",Ae.user.whatsappNumber||"\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d"]}),Ae.agency&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(i.A,{}),(0,R.jsx)(U,{level:5,children:"\u0410\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e"}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435:"})," ",Ae.agency.name]}),Ae.agency.logo&&(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{children:(0,R.jsx)("strong",{children:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f:"})}),(0,R.jsx)("img",{src:Ae.agency.logo,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430",style:{maxWidth:200,maxHeight:100,objectFit:"contain"}})]})]}),Ae.user.documents&&Ae.user.documents.length>0&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(i.A,{}),(0,R.jsx)(U,{level:5,children:"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b"}),(0,R.jsx)(n.A,{dataSource:Ae.user.documents,renderItem:(e,s)=>(0,R.jsx)(n.A.Item,{children:(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{children:(0,R.jsxs)("strong",{children:["\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442 ",s+1,":"]})}),(0,R.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",onClick:s=>{if(!e||"null"===e||"undefined"===e)return s.preventDefault(),m.Ay.error("\u0424\u0430\u0439\u043b \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"),!1},children:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442"})]})})})]}),Ae.endorsements&&Ae.endorsements.length>0&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(i.A,{}),(0,R.jsx)(U,{level:5,children:"\u041f\u043e\u0440\u0443\u0447\u0438\u0442\u0435\u043b\u044c\u0441\u0442\u0432\u0430 (\u0434\u043b\u044f \u0447\u0430\u0441\u0442\u043d\u043e\u0433\u043e \u0440\u0438\u044d\u043b\u0442\u043e\u0440\u0430)"}),(0,R.jsx)(n.A,{dataSource:Ae.endorsements,renderItem:e=>(0,R.jsx)(n.A.Item,{children:(0,R.jsxs)("div",{children:[(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0410\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e:"})," ",e.agency.name]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0421\u0442\u0430\u0442\u0443\u0441:"})," ",e.status]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0414\u0430\u0442\u0430:"})," ",new Date(e.createdAt).toLocaleString("ru-RU")]})]})})})]}),(0,R.jsx)(i.A,{}),(0,R.jsx)("div",{style:{textAlign:"center",marginTop:24},children:(0,R.jsxs)(u.A,{children:[(0,R.jsx)(j.Ay,{type:"primary",size:"large",onClick:()=>(async e=>{try{await(0,E.Sr)(e),m.Ay.success("\u0417\u0430\u044f\u0432\u043a\u0430 \u043e\u0434\u043e\u0431\u0440\u0435\u043d\u0430"),ge(!1),ve(null),Ie()}catch(s){m.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0434\u043e\u0431\u0440\u0435\u043d\u0438\u0438 \u0437\u0430\u044f\u0432\u043a\u0438")}})(Ae.user.id),children:"\u041e\u0434\u043e\u0431\u0440\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"}),(0,R.jsx)(j.Ay,{type:"default",size:"large",danger:!0,onClick:()=>we(!0),children:"\u041e\u0442\u043a\u043b\u043e\u043d\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"})]})})]})}),(0,R.jsxs)(l.A,{title:"\u041e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u044f\u0432\u043a\u0438",open:fe,onCancel:()=>we(!1),footer:null,width:500,children:[(0,R.jsxs)("div",{style:{marginBottom:16},children:[(0,R.jsx)("p",{children:"\u0412\u044b \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u0442\u0435\u0441\u044c \u043e\u0442\u043a\u043b\u043e\u043d\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f:"}),(0,R.jsx)("p",{children:(0,R.jsxs)("strong",{children:[null===Ae||void 0===Ae||null===(e=Ae.user)||void 0===e?void 0:e.firstName," ",null===Ae||void 0===Ae||null===(s=Ae.user)||void 0===s?void 0:s.lastName," ",null===Ae||void 0===Ae||null===(t=Ae.user)||void 0===t?void 0:t.middleName]})}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"Email:"})," ",null===Ae||void 0===Ae||null===(v=Ae.user)||void 0===v?void 0:v.email]}),(0,R.jsxs)("p",{children:[(0,R.jsx)("strong",{children:"\u0420\u043e\u043b\u044c:"})," ",null===Ae||void 0===Ae||null===(f=Ae.user)||void 0===f?void 0:f.role]})]}),(0,R.jsxs)(g.A,{form:Se,onFinish:async e=>{if(Ae)try{await(0,E.eZ)(Ae.user.id,e.reason),m.Ay.success("\u0417\u0430\u044f\u0432\u043a\u0430 \u043e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0430"),we(!1),ge(!1),ve(null),Se.resetFields(),Ie()}catch(s){m.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u0438 \u0437\u0430\u044f\u0432\u043a\u0438")}},children:[(0,R.jsx)(g.A.Item,{name:"reason",label:"\u041f\u0440\u0438\u0447\u0438\u043d\u0430 \u043e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u044f",rules:[{required:!0,message:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u0440\u0438\u0447\u0438\u043d\u0443 \u043e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u044f"},{min:10,message:"\u041f\u0440\u0438\u0447\u0438\u043d\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 10 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}],children:(0,R.jsx)(B,{rows:4,placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u043f\u0440\u0438\u0447\u0438\u043d\u0443 \u043e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u044f\u0432\u043a\u0438...",maxLength:500,showCount:!0})}),(0,R.jsx)(g.A.Item,{style:{textAlign:"center",marginTop:24},children:(0,R.jsxs)(u.A,{children:[(0,R.jsx)(j.Ay,{type:"default",onClick:()=>we(!1),children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),(0,R.jsx)(j.Ay,{type:"primary",danger:!0,htmlType:"submit",icon:(0,R.jsx)(_.A,{}),children:"\u041e\u0442\u043a\u043b\u043e\u043d\u0438\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0443"})]})})]})]})]})}},9145:(e,s,t)=>{t.d(s,{$D:()=>h,PW:()=>l,Sr:()=>p,Vo:()=>c,_C:()=>i,bd:()=>n,eZ:()=>x,g1:()=>a,tX:()=>d,x7:()=>o});var r=t(6291);const n=async e=>(await r.Ay.post("/api/support/requests",e)).data,i=async()=>(await r.Ay.get("/api/support/requests")).data,a=async e=>(await r.Ay.patch(`/api/support/requests/${e}/assign`)).data,l=async(e,s)=>(await r.Ay.patch(`/api/support/requests/${e}/resolve`,{resolution:s})).data,o=async e=>(await r.Ay.patch(`/api/support/requests/${e}/close`)).data,c=async()=>(await r.Ay.get("/api/support/stats")).data,d=async()=>(await r.Ay.get("/api/support/agency-authorization/pending")).data,h=async e=>(await r.Ay.get(`/api/support/agency-authorization/${e}`)).data,p=async e=>(await r.Ay.patch(`/api/support/agency-authorization/${e}/approve`)).data,x=async(e,s)=>(await r.Ay.patch(`/api/support/agency-authorization/${e}/reject`,{reason:s})).data}}]);
//# sourceMappingURL=5433.e9bf7fc4.chunk.js.map