"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6506],{1579:(e,t,r)=>{r.d(t,{IR:()=>l,Xc:()=>a,Xx:()=>i,qz:()=>n,vu:()=>s});var o=r(6291);const a=async e=>{const t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[r,o]=e;void 0!==o&&null!==o&&""!==o&&t.append(r,o.toString())});const r=await o.Ay.get(`/api/properties?${t.toString()}`);return Array.isArray(r.data)?r.data:r.data&&Array.isArray(r.data.properties)?r.data.properties:[]},n=async e=>(await o.Ay.get(`/api/properties/${e}`)).data,l=async e=>a({agentId:e}),i=async()=>{const e=await o.Ay.get("/api/properties?sort=createdAt_desc&limit=10");return Array.isArray(e.data)?e.data:e.data&&Array.isArray(e.data.properties)?e.data.properties:[]},s=async(e,t,r)=>(await o.Ay.patch(`/api/properties/${e}/status`,{status:t},r?{headers:{Authorization:`Bearer ${r}`}}:void 0)).data},3072:(e,t,r)=>{r.d(t,{Cf:()=>i,Jm:()=>p,M0:()=>g,P1:()=>n,RL:()=>c,SJ:()=>l,Yl:()=>a,am:()=>u,ic:()=>s,kT:()=>d,nk:()=>f});var o=r(6291);async function a(){try{return(await o.Ay.get("/api/selections")).data}catch(e){if(e.response&&404===e.response.status)return[];throw e}}async function n(e,t){const r=t?{Authorization:`Bearer ${t}`}:void 0;return(await o.Ay.post("/api/selections",{title:e,propertyIds:[]},r?{headers:r}:void 0)).data}async function l(e,t){const r=(await o.Ay.get(`/api/selections/${e}`)).data;if(!r.propertyIds.includes(t)){const a=[...r.propertyIds,t];await o.Ay.put(`/api/selections/${e}`,{title:r.title,propertyIds:a})}}async function i(e,t){const r=(await o.Ay.get(`/api/selections/${e}`)).data,a=r.propertyIds.filter(e=>e!==t);await o.Ay.put(`/api/selections/${e}`,{title:r.title,propertyIds:a})}async function s(e){await o.Ay.delete(`/api/selections/${e}`)}async function c(e){return(await o.Ay.get(`/api/selections/${e}`)).data}async function d(e){return(await o.Ay.get(`/api/selections/${e}/client-likes`)).data}function u(e){return`${window.location.origin}/client-selection/${e}`}async function p(e){var t;const r=await o.Ay.get(`/api/selections/${e}/pdf`,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([r.data],{type:"application/pdf"})),n=document.createElement("a");n.href=a,n.setAttribute("download",`selection_${e}.pdf`),document.body.appendChild(n),n.click(),null===(t=n.parentNode)||void 0===t||t.removeChild(n),window.URL.revokeObjectURL(a)}async function g(e){return(await o.Ay.get(`/api/selections/client/${e}`)).data}async function f(e,t,r){await o.Ay.post(`/api/selections/client/${e}/like`,{propertyId:t,liked:r})}},5554:(e,t,r)=>{r.d(t,{A:()=>u});var o=r(6909),a=r(6317),n=r(6658),l=r(6553),i=r(2019),s=r(5043),c=r(3072),d=r(579);const u=e=>{let{open:t,propertyId:r,onClose:u,createOnly:p}=e;const[g,f]=(0,s.useState)([]),[y,h]=(0,s.useState)(),[x,b]=(0,s.useState)(""),[m,v]=(0,s.useState)(!1),[w,j]=(0,s.useState)(!1),A=localStorage.getItem("token");(0,s.useEffect)(()=>{t&&((0,c.Yl)().then(f),h(void 0),b(""))},[t]);const S=async()=>{if(x.trim()){v(!0);try{const e=await(0,c.P1)(x.trim(),A||void 0);f(t=>[...t,e]),h(e.id),b(""),i.Ay.success("\u041f\u043e\u0434\u0431\u043e\u0440\u043a\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0430"),p&&u()}finally{v(!1)}}};return(0,d.jsx)(o.A,{open:t,onCancel:u,footer:null,title:p?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043e\u0434\u0431\u043e\u0440\u043a\u0443":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043f\u043e\u0434\u0431\u043e\u0440\u043a\u0443",destroyOnHidden:!0,children:(0,d.jsxs)("div",{onClick:e=>e.stopPropagation(),children:[!p&&(0,d.jsxs)("div",{style:{marginBottom:16},children:[(0,d.jsx)("div",{style:{marginBottom:8,fontWeight:500},children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u0434\u0431\u043e\u0440\u043a\u0443"}),(0,d.jsx)(l.A,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u0434\u0431\u043e\u0440\u043a\u0443",value:y,onChange:h,options:g.map(e=>({label:e.title,value:e.id})),allowClear:!0})]}),(0,d.jsxs)("div",{style:{marginBottom:16},children:[(0,d.jsx)("div",{style:{marginBottom:8,fontWeight:500},children:"\u0418\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043d\u043e\u0432\u0443\u044e"}),(0,d.jsx)(n.A,{placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0434\u0431\u043e\u0440\u043a\u0438",value:x,onChange:e=>b(e.target.value),style:{width:"calc(100% - 110px)",marginRight:8},onPressEnter:S}),(0,d.jsx)(a.Ay,{type:"primary",onClick:S,disabled:!x.trim(),loading:m,children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]}),!p&&(0,d.jsx)(a.Ay,{type:"primary",block:!0,disabled:!y,onClick:e=>{e.stopPropagation(),(async()=>{if(y&&r){j(!0);try{await(0,c.SJ)(y,r),i.Ay.success("\u041e\u0431\u044a\u0435\u043a\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d \u0432 \u043f\u043e\u0434\u0431\u043e\u0440\u043a\u0443"),u()}finally{j(!1)}}})()},loading:w,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})]})})}},6506:(e,t,r)=>{r.r(t),r.d(t,{default:()=>G});var o=r(6909),a=r(6051),n=r(5297),l=r(5964),i=r(6399),s=r(3567),c=r(2513),d=r(6317),u=r(6553),p=r(585),g=r(6658),f=r(5043),y=r(1579),h=r(3716),x=r.n(h),b=(r(7199),r(579));function m(e){let{map:t,lngLat:r,property:o}=e;const a=(0,f.useRef)(null);return(0,f.useEffect)(()=>{if(!t)return;const e=new(x().Marker)({anchor:"bottom"}).setLngLat(r).addTo(t),n=new(x().Popup)({offset:24}).setHTML(`\n        <div style='min-width:180px'>\n          ${Array.isArray(o.photos)&&o.photos.length>0?`<img src='${o.photos[0]}' alt='\u0424\u043e\u0442\u043e' style='width:100%;height:110px;object-fit:cover;border-radius:8px 8px 0 0;margin-bottom:6px;' />`:"<div style='width:100%;height:110px;background:#f3f6fa;color:#b0b8c9;display:flex;align-items:center;justify-content:center;border-radius:8px 8px 0 0;margin-bottom:6px;'>\u041d\u0435\u0442 \u0444\u043e\u0442\u043e</div>"}\n          <div style='font-weight:600;font-size:16px;margin-bottom:2px;'>${o.title||"\u041e\u0431\u044a\u0435\u043a\u0442"}</div>\n          <div style='color:#64748b;font-size:13px;margin-bottom:4px;'>${o.address||""}</div>\n          <div style='color:#222;font-size:18px;font-weight:400;margin-bottom:2px;'>${o.price?Number(o.price).toLocaleString("ru-RU")+" \u0440\u0443\u0431":""}</div>\n          <a href='/properties/${o.id}'\n             style='display:inline-block;margin-top:8px;padding:7px 18px;background:#2563eb;color:#fff;border-radius:7px;font-size:14px;font-weight:500;text-decoration:none;transition:background 0.18s;box-shadow:0 2px 8px rgba(37,99,235,0.08);text-align:center;'\n             onmouseover="this.style.background='#1741a6'" onmouseout="this.style.background='#2563eb'">\n            \u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435\n          </a>\n        </div>\n      `);return e.setPopup(n),a.current=e,()=>{a.current&&a.current.remove()}},[t,r,o]),null}const v=[57.6261,39.8845],w="mapbox_last_view";const j=e=>{let{properties:t,selectedId:r,onSelect:o,initialCenter:a,initialZoom:n,style:l={height:500,width:"100%",borderRadius:16},mapRef:i,freehandMode:s=!1,onPolygonDraw:c,polygonCoords:d=[]}=e;const u=(0,f.useRef)(null),p=(0,f.useRef)(null),[g,y]=(0,f.useState)(!1),h=(0,f.useRef)(v),j=(0,f.useRef)(12),[A,S]=(0,f.useState)(!1),[k,C]=(0,f.useState)([]),[R,L]=(0,f.useState)(null),[z,T]=(0,f.useState)(!1);return(0,f.useEffect)(()=>{let e=!1;const t=localStorage.getItem(w);if(t)try{const{center:r,zoom:o}=JSON.parse(t);Array.isArray(r)&&"number"===typeof o&&(h.current=[r[0],r[1]],j.current=o,e=!0)}catch{}e||(h.current=a||v,j.current=n||12,fetch("https://ip-api.com/json/?fields=lat,lon,status").then(e=>e.json()).then(e=>{"success"===e.status&&"number"===typeof e.lat&&"number"===typeof e.lon&&localStorage.setItem(w,JSON.stringify({center:[e.lon,e.lat],zoom:11}))}))},[a,n]),(0,f.useEffect)(()=>{if(!u.current||p.current)return;const e=new(x().Map)({container:u.current,style:"https://tiles.stadiamaps.com/styles/osm_bright.json",center:h.current,zoom:j.current,pitch:45,bearing:-17.6});return p.current=e,i&&(i.current=e),e.on("load",()=>y(!0)),e.on("moveend",()=>{const t=e.getCenter(),r=e.getZoom();localStorage.setItem(w,JSON.stringify({center:[t.lng,t.lat],zoom:r}))}),e.on("zoomend",()=>{const t=e.getCenter(),r=e.getZoom();localStorage.setItem(w,JSON.stringify({center:[t.lng,t.lat],zoom:r}))}),()=>{e.remove(),p.current=null,i&&(i.current=null)}},[i]),(0,f.useEffect)(()=>{if(!p.current||!r)return;const e=t.find(e=>Number(e.id)===Number(r));e&&"number"===typeof e.lat&&"number"===typeof e.lng&&p.current.flyTo({center:[e.lng,e.lat],zoom:p.current.getZoom(),speed:1.2})},[r,t]),(0,f.useEffect)(()=>{if(!p.current)return;const e=p.current;let t=!1,r=[],o=R||"drawn-polygon";function a(o){s&&0===o.originalEvent.button&&(t=!0,r=[[o.lngLat.lng,o.lngLat.lat]],C([[o.lngLat.lng,o.lngLat.lat]]),S(!0),T(!0),e.getCanvas().style.cursor="pointer")}function n(e){s&&t&&(r.push([e.lngLat.lng,e.lngLat.lat]),C([...r]))}function l(a){s&&t&&(t=!1,r.push([a.lngLat.lng,a.lngLat.lat]),C([...r]),S(!1),T(!1),L(o),function(e,t,r){if(t.length<3)return;if(e.getSource(r))return void e.getSource(r).setData({type:"Feature",geometry:{type:"Polygon",coordinates:[[...t,t[0]]]},properties:{}});e.addSource(r,{type:"geojson",data:{type:"Feature",geometry:{type:"Polygon",coordinates:[[...t,t[0]]]},properties:{}}}),e.addLayer({id:r,type:"fill",source:r,paint:{"fill-color":"#2563eb","fill-opacity":.18}}),e.addLayer({id:r+"-outline",type:"line",source:r,paint:{"line-color":"#2563eb","line-width":2.5}})}(e,r,o),e.getCanvas().style.cursor="",c&&c(r))}return s&&(e.on("mousedown",a),e.on("mousemove",n),e.on("mouseup",l),T(!0),e.getCanvas().style.cursor="pointer"),()=>{e.off("mousedown",a),e.off("mousemove",n),e.off("mouseup",l),T(!1),e.getCanvas().style.cursor=""}},[s,p.current,c,R]),(0,f.useEffect)(()=>{if(!p.current)return;const e=p.current,t="draw-polyline";if(k.length>1&&s){const r={type:"Feature",geometry:{type:"LineString",coordinates:k},properties:{}};e.getSource(t)?e.getSource(t).setData(r):(e.addSource(t,{type:"geojson",data:r}),e.addLayer({id:t,type:"line",source:t,paint:{"line-color":"#2563eb","line-width":3.5,"line-dasharray":[2,2]}}))}else e.getLayer(t)&&e.removeLayer(t),e.getSource(t)&&e.removeSource(t)},[k,s]),(0,f.useEffect)(()=>{if(!p.current)return;const e=p.current,t="drawn-polygon",r="drawn-polygon-outline";if(Array.isArray(d)&&d.length<=2)return e.getLayer(t)&&e.removeLayer(t),e.getSource(t)&&e.removeSource(t),e.getLayer(r)&&e.removeLayer(r),void(e.getSource(r)&&e.removeSource(r));const o={type:"Feature",geometry:{type:"Polygon",coordinates:[[...d,d[0]]]},properties:{}};e.getSource(t)?e.getSource(t).setData(o):(e.addSource(t,{type:"geojson",data:o}),e.addLayer({id:t,type:"fill",source:t,paint:{"fill-color":"#2563eb","fill-opacity":.18}}),e.addLayer({id:r,type:"line",source:t,paint:{"line-color":"#2563eb","line-width":2.5}}))},[d]),(0,f.useEffect)(()=>{if(!p.current)return;const e=p.current,t="draw-polyline";s?(e.boxZoom.disable(),e.dragPan.disable(),e.scrollZoom.disable(),e.keyboard.disable(),e.doubleClickZoom.disable(),e.touchZoomRotate.disable()):(e.boxZoom.enable(),e.dragPan.enable(),e.scrollZoom.enable(),e.keyboard.enable(),e.doubleClickZoom.enable(),e.touchZoomRotate.enable()),s||(e.getLayer(t)&&e.removeLayer(t),e.getSource(t)&&e.removeSource(t),C([]))},[s]),(0,f.useEffect)(()=>{if(!p.current)return;const e=p.current,t="drawn-polygon",r="drawn-polygon-outline";Array.isArray(d)&&0===d.length&&(e.getLayer(t)&&e.removeLayer(t),e.getSource(t)&&e.removeSource(t),e.getLayer(r)&&e.removeLayer(r),e.getSource(r)&&e.removeSource(r))},[d]),(0,b.jsxs)("div",{style:l,children:[(0,b.jsx)("div",{ref:u,style:{width:"100%",height:"100%"}}),g&&p.current&&t.map(e=>"number"===typeof e.lat&&"number"===typeof e.lng&&(0,b.jsx)(m,{map:p.current,lngLat:[e.lng,e.lat],property:e},e.id))]})};var A=r(2411),S=r(6011),k=r(3756),C=r(7848),R=r(7914),L=r(4811),z=r(617),T=r(4471),I=r(6881),$=r(2639),P=r(1903),M=r(2214),W=r(8463),O=r(5554),E=r(6525),B=r(5534),N=r(4786),Z=r(3847),F=r(7534),_=r(1283),U=r(3259);const D=[57.6261,39.8845],J="mapbox_last_view";const Y=(e,t)=>{let r=!1;for(let o=0,a=t.length-1;o<t.length;a=o++){const n=t[o][0],l=t[o][1],i=t[a][0],s=t[a][1];l>e[1]!==s>e[1]&&e[0]<(i-n)*(e[1]-l)/(s-l+1e-7)+n&&(r=!r)}return r},H=[{value:"apartment",label:"\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430"},{value:"house",label:"\u0414\u043e\u043c"},{value:"commercial",label:"\u041a\u043e\u043c\u043c\u0435\u0440\u0446\u0438\u044f"},{value:"land",label:"\u0423\u0447\u0430\u0441\u0442\u043e\u043a"}],X=[{value:"for_sale",label:"\u0412 \u043f\u0440\u043e\u0434\u0430\u0436\u0435"},{value:"in_deal",label:"\u041d\u0430 \u0437\u0430\u0434\u0430\u0442\u043a\u0435"},{value:"reserved",label:"\u041d\u0430 \u0431\u0440\u043e\u043d\u0438"},{value:"sold",label:"\u041f\u0440\u043e\u0434\u0430\u043d"}],q=[{value:"panel",label:"\u041f\u0430\u043d\u0435\u043b\u044c"},{value:"brick",label:"\u041a\u0438\u0440\u043f\u0438\u0447"},{value:"monolith",label:"\u041c\u043e\u043d\u043e\u043b\u0438\u0442"},{value:"block",label:"\u0411\u043b\u043e\u043a"},{value:"wood",label:"\u0414\u0435\u0440\u0435\u0432\u043e"}],Q=[{value:"newest",label:"\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u043d\u043e\u0432\u044b\u0435"},{value:"cheapest",label:"\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0434\u0435\u0448\u0451\u0432\u044b\u0435"},{value:"expensive",label:"\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0434\u043e\u0440\u043e\u0433\u0438\u0435"},{value:"largest",label:"\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0431\u043e\u043b\u044c\u0448\u0438\u0435"}],G=()=>{const[e,t]=(0,f.useState)([]),[r,h]=(0,f.useState)(null),[x,m]=(0,f.useState)(!1),[v,w]=(0,f.useState)(""),{isClientMode:G}=(0,U.Q)(),[K,V]=(0,f.useState)(D),[ee,te]=(0,f.useState)(12),re=(0,f.useRef)(null);(0,f.useEffect)(()=>{const e=localStorage.getItem(J);if(e)try{const{center:t,zoom:r}=JSON.parse(e);if(Array.isArray(t)&&"number"===typeof r)return V([t[0],t[1]]),void te(r)}catch{}V(D),te(12)},[]),(0,f.useEffect)(()=>{localStorage.getItem(J)||fetch("https://ip-api.com/json/?fields=lat,lon,status").then(e=>e.json()).then(e=>{"success"===e.status&&"number"===typeof e.lat&&"number"===typeof e.lon&&re.current&&re.current.flyTo&&re.current.flyTo({center:[e.lon,e.lat],zoom:11,speed:1.2})})},[]),(0,f.useEffect)(()=>{m(!0),(0,y.Xx)().then(e=>{Array.isArray(e)?t(e):e&&"object"===typeof e&&Array.isArray(e.properties)?t(e.properties):t([])}).catch(()=>w("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432")).finally(()=>m(!1))},[]);const[oe,ae]=(0,f.useState)(!1),[ne,le]=(0,f.useState)([]),[ie,se]=(0,f.useState)(!1),[ce,de]=(0,f.useState)({}),ue=e=>de(t=>({...t,...e})),[pe,ge]=(0,f.useState)(!1);let fe=e;if(ne.length>2){const e=function(e){return e>=16?10:e>=14?25:e>=12?50:e>=10?100:200}(ee),t=e/111320;fe=fe.filter(e=>{if("number"!==typeof e.lat||"number"!==typeof e.lng)return!1;if(Y([e.lng,e.lat],ne))return!0;for(let r=0;r<8;r++){const o=2*Math.PI*r/8,a=Math.cos(o)*t,n=Math.sin(o)*t,l=e.lng+a,i=e.lat+n;if(Y([l,i],ne))return!0}return!1})}const ye=(0,_.Zp)(),[he,xe]=(0,f.useState)(null),[be,me]=(0,f.useState)({open:!1}),ve={transition:"transform 0.13s cubic-bezier(.4,2,.6,1), box-shadow 0.13s",boxShadow:"0 1px 4px rgba(37,99,235,0.08)"};return(0,b.jsxs)("div",{style:{display:"flex",height:"calc(100vh - 64px)",background:"#f7fafd",padding:0,margin:0,overflow:"hidden"},children:[(0,b.jsxs)("div",{style:{flex:1,minWidth:0,height:"100%",background:"#f7fafd",position:"relative"},children:[(0,b.jsx)(s.A,{content:(0,b.jsxs)("div",{style:{minWidth:320,maxWidth:420},children:[(0,b.jsx)(g.A,{prefix:(0,b.jsx)(A.A,{style:{color:"#b0b6c3"}}),placeholder:"\u041f\u043e\u0438\u0441\u043a (\u0430\u0434\u0440\u0435\u0441, \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435, \u0430\u0433\u0435\u043d\u0442, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435)",value:ce.search||"",onChange:e=>ue({search:e.target.value}),style:{width:"100%",borderRadius:14,background:"rgba(247,249,252,0.9)",border:"1.5px solid #e6eaf1",fontWeight:500,marginBottom:10},allowClear:!0}),(0,b.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:10},children:[(0,b.jsx)(p.A,{prefix:(0,b.jsx)(S.A,{style:{color:"#b0b6c3"}}),placeholder:"\u0426\u0435\u043d\u0430 \u043e\u0442",min:0,value:ce.minPrice,onChange:e=>ue({minPrice:null===e?void 0:e}),style:{width:100,borderRadius:14,background:"rgba(247,249,252,0.9)",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(p.A,{placeholder:"\u0434\u043e",min:0,value:ce.maxPrice,onChange:e=>ue({maxPrice:null===e?void 0:e}),style:{width:100,borderRadius:14,background:"rgba(247,249,252,0.9)",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(p.A,{prefix:(0,b.jsx)(k.A,{style:{color:"#b0b6c3"}}),placeholder:"\u041f\u043b\u043e\u0449\u0430\u0434\u044c \u043e\u0442",min:0,value:ce.minArea,onChange:e=>ue({minArea:null===e?void 0:e}),style:{width:90,borderRadius:14,background:"rgba(247,249,252,0.9)",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(p.A,{placeholder:"\u0434\u043e",min:0,value:ce.maxArea,onChange:e=>ue({maxArea:null===e?void 0:e}),style:{width:90,borderRadius:14,background:"rgba(247,249,252,0.9)",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(p.A,{prefix:(0,b.jsx)(C.A,{style:{color:"#b0b6c3"}}),placeholder:"\u041a\u043e\u043c\u043d\u0430\u0442",min:1,max:10,value:ce.rooms,onChange:e=>ue({rooms:null===e?void 0:e}),style:{width:70,borderRadius:14,background:"rgba(247,249,252,0.9)",border:"1.5px solid #e6eaf1"}})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:10},children:[(0,b.jsx)(u.A,{placeholder:"\u0422\u0438\u043f",allowClear:!0,value:ce.type,onChange:e=>ue({type:e}),options:H,style:{width:120,borderRadius:14,background:"rgba(247,249,252,0.9)",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(u.A,{placeholder:"\u0421\u0442\u0430\u0442\u0443\u0441",allowClear:!0,value:ce.status,onChange:e=>ue({status:e}),options:X,style:{width:120,borderRadius:14,background:"rgba(247,249,252,0.9)",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(u.A,{placeholder:"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430",allowClear:!0,value:ce.sort,onChange:e=>ue({sort:e}),options:Q,style:{width:140,borderRadius:14,background:"rgba(247,249,252,0.9)",border:"1.5px solid #e6eaf1"}})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:10},children:[(0,b.jsx)(d.Ay,{icon:pe?(0,b.jsx)(R.A,{}):(0,b.jsx)(L.A,{}),shape:"circle",onClick:()=>ge(e=>!e),style:{background:"#f3f6fa",border:"1.5px solid #e0e7ef"}}),(0,b.jsx)(d.Ay,{icon:(0,b.jsx)(z.A,{}),onClick:()=>de({}),style:{borderRadius:14,fontWeight:500,height:38,background:"#f3f6fa",border:"1.5px solid #e0e7ef"},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c"}),(0,b.jsx)(d.Ay,{type:oe?"primary":"default",icon:(0,b.jsx)(T.A,{}),style:{fontWeight:600,fontSize:16,borderRadius:8,flex:1},onClick:()=>{se(!1),setTimeout(()=>ae(!0),100)},children:"\u041d\u0430\u0440\u0438\u0441\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u043b\u0430\u0441\u0442\u044c \u043d\u0430 \u043a\u0430\u0440\u0442\u0435"}),ne.length>2&&(0,b.jsx)(d.Ay,{danger:!0,style:{flex:1},onClick:()=>le([]),children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u043e\u0431\u043b\u0430\u0441\u0442\u044c"})]}),pe&&(0,b.jsxs)("div",{style:{width:"100%",marginTop:8,display:"flex",flexWrap:"wrap",gap:10,alignItems:"center",background:"rgba(255,255,255,0.35)",borderRadius:12,padding:12,boxShadow:"0 2px 12px #e0e7ef"},children:[(0,b.jsx)(p.A,{prefix:(0,b.jsx)(I.A,{style:{color:"#b0b6c3"}}),placeholder:"\u0413\u043e\u0434 \u043f\u043e\u0441\u0442\u0440. \u043e\u0442",min:1900,max:2100,value:ce.minYear,onChange:e=>ue({minYear:null===e?void 0:e}),style:{width:100,borderRadius:12,background:"#f7f9fc",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(p.A,{placeholder:"\u0434\u043e",min:1900,max:2100,value:ce.maxYear,onChange:e=>ue({maxYear:null===e?void 0:e}),style:{width:80,borderRadius:12,background:"#f7f9fc",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(p.A,{prefix:(0,b.jsx)($.A,{style:{color:"#b0b6c3"}}),placeholder:"\u042d\u0442\u0430\u0436 \u043e\u0442",min:1,value:ce.minFloor,onChange:e=>ue({minFloor:null===e?void 0:e}),style:{width:80,borderRadius:12,background:"#f7f9fc",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(p.A,{placeholder:"\u0434\u043e",min:1,value:ce.maxFloor,onChange:e=>ue({maxFloor:null===e?void 0:e}),style:{width:80,borderRadius:12,background:"#f7f9fc",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(p.A,{prefix:(0,b.jsx)(P.A,{style:{color:"#b0b6c3"}}),placeholder:"\u042d\u0442\u0430\u0436\u0435\u0439 \u0432 \u0434\u043e\u043c\u0435 \u043e\u0442",min:1,value:ce.minFloors,onChange:e=>ue({minFloors:null===e?void 0:e}),style:{width:80,borderRadius:12,background:"#f7f9fc",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(p.A,{placeholder:"\u0434\u043e",min:1,value:ce.maxFloors,onChange:e=>ue({maxFloors:null===e?void 0:e}),style:{width:80,borderRadius:12,background:"#f7f9fc",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(u.A,{placeholder:"\u041c\u0430\u0442\u0435\u0440\u0438\u0430\u043b",allowClear:!0,value:ce.material,onChange:e=>ue({material:e}),options:q,style:{width:120,borderRadius:12,background:"#f7f9fc",border:"1.5px solid #e6eaf1"}}),(0,b.jsx)(c.A,{checked:!!ce.balcony,onChange:e=>ue({balcony:e.target.checked}),children:"\u0411\u0430\u043b\u043a\u043e\u043d"}),(0,b.jsx)(c.A,{checked:!!ce.lift,onChange:e=>ue({lift:e.target.checked}),children:"\u041b\u0438\u0444\u0442"}),(0,b.jsxs)(c.A,{checked:!!ce.parking,onChange:e=>ue({parking:e.target.checked}),children:[(0,b.jsx)(M.A,{style:{marginRight:4}}),"\u041f\u0430\u0440\u043a\u043e\u0432\u043a\u0430"]}),(0,b.jsx)(c.A,{checked:!!ce.furniture,onChange:e=>ue({furniture:e.target.checked}),children:"\u041c\u0435\u0431\u0435\u043b\u044c"}),(0,b.jsx)(c.A,{checked:!!ce.tech,onChange:e=>ue({tech:e.target.checked}),children:"\u0422\u0435\u0445\u043d\u0438\u043a\u0430"}),(0,b.jsxs)(c.A,{checked:!!ce.onlyWithPhoto,onChange:e=>ue({onlyWithPhoto:e.target.checked}),children:[(0,b.jsx)(T.A,{style:{marginRight:4}}),"\u0422\u043e\u043b\u044c\u043a\u043e \u0441 \u0444\u043e\u0442\u043e"]}),(0,b.jsx)(c.A,{checked:!!ce.isNew,onChange:e=>ue({isNew:e.target.checked}),children:"\u041d\u043e\u0432\u043e\u0441\u0442\u0440\u043e\u0439\u043a\u0430"}),(0,b.jsx)(c.A,{checked:!!ce.isSecondary,onChange:e=>ue({isSecondary:e.target.checked}),children:"\u0412\u0442\u043e\u0440\u0438\u0447\u043a\u0430"})]})]}),title:"\u0424\u0438\u043b\u044c\u0442\u0440\u044b \u0438 \u0440\u0438\u0441\u043e\u0432\u0430\u043d\u0438\u0435",trigger:"click",open:ie,onOpenChange:se,children:(0,b.jsx)(d.Ay,{icon:(0,b.jsx)(W.A,{}),size:"large",style:{fontWeight:600,fontSize:18,height:48,borderRadius:12,position:"absolute",top:18,right:18,zIndex:20},children:"\u0424\u0438\u043b\u044c\u0442\u0440\u044b \u0438 \u0440\u0438\u0441\u043e\u0432\u0430\u043d\u0438\u0435"})}),(0,b.jsx)(j,{mapRef:re,properties:e,selectedId:r,onSelect:h,initialCenter:K,initialZoom:ee,style:{width:"100%",height:"100%",borderRadius:0},freehandMode:oe,onPolygonDraw:e=>{le(e),ae(!1)},polygonCoords:ne})]}),(0,b.jsxs)("div",{style:{width:420,minWidth:420,maxWidth:420,height:"100%",background:"#f9fbfd",borderLeft:"1.5px solid #e5e7eb",padding:"24px 20px 24px 20px",overflowY:"auto",flexShrink:0},children:[(0,b.jsx)("div",{style:{fontWeight:700,fontSize:26,marginBottom:18,color:"#222",letterSpacing:-.5},children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432"}),x&&(0,b.jsx)("div",{style:{color:"#888",margin:"24px 0"},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}),v&&(0,b.jsx)("div",{style:{color:"#e53e3e",margin:"24px 0"},children:v}),!x&&!v&&0===fe.length&&(0,b.jsx)("div",{style:{color:"#888",margin:"24px 0"},children:"\u041d\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f"}),fe.map(e=>{var t,o,a,n,s,c,u;const p={for_sale:{label:"\u0412 \u043f\u0440\u043e\u0434\u0430\u0436\u0435",color:"green"},in_deal:{label:"\u041d\u0430 \u0437\u0430\u0434\u0430\u0442\u043a\u0435",color:"orange"},reserved:{label:"\u041d\u0430 \u0431\u0440\u043e\u043d\u0438",color:"blue"},sold:{label:"\u041f\u0440\u043e\u0434\u0430\u043d",color:"red"}}[e.status]||{label:String(e.status),color:"gray"},g=(null===(t=e.legalCheck)||void 0===t?void 0:t.status)||"\u041d\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043d";let f=(0,b.jsx)(E.A,{style:{fontSize:18,color:"#faad14"}}),y="#faad14",x="\u041d\u0435 \u043f\u0440\u043e\u0432\u0435\u0440\u0435\u043d";"\u041f\u0440\u043e\u0432\u0435\u0440\u0435\u043d"===g?(f=(0,b.jsx)(E.A,{style:{fontSize:18,color:"#52c41a"}}),y="#52c41a",x="\u041f\u0440\u043e\u0432\u0435\u0440\u0435\u043d"):"\u041d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435"===g&&(f=(0,b.jsx)(B.A,{spin:!0,style:{fontSize:18,color:"#1890ff"}}),y="#1890ff",x="\u041d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435");return(0,b.jsxs)("div",{style:{background:r===e.id?"#eaf2ff":"#fff",border:r===e.id?"2px solid #2563eb":"2px solid #e5e7eb",borderRadius:14,padding:16,marginBottom:16,cursor:"pointer",boxShadow:r===e.id?"0 2px 12px rgba(37,99,235,0.08)":"0 1px 4px rgba(0,0,0,0.03)",transition:"all 0.18s",display:"flex",gap:16,alignItems:"flex-start",position:"relative",minHeight:120},onClick:()=>h(e.id),children:[(0,b.jsx)("div",{style:{width:56,height:56,borderRadius:10,background:"#f3f6fa",overflow:"hidden",flexShrink:0,display:"flex",alignItems:"center",justifyContent:"center"},children:Array.isArray(e.photos)&&e.photos.length>0?(0,b.jsx)("img",{src:e.photos[0],alt:e.title,style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,b.jsx)("div",{style:{color:"#b0b8c9",fontSize:13},children:"No photo"})}),(0,b.jsxs)("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:4},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:2},children:[(0,b.jsx)(i.A,{color:"purple",style:{fontWeight:600,fontSize:12},children:"\u042d\u043a\u0441\u043a\u043b\u044e\u0437\u0438\u0432\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442"}),(0,b.jsx)(i.A,{color:p.color,style:{fontWeight:600,fontSize:12},children:p.label})]}),(0,b.jsx)("div",{style:{fontWeight:600,fontSize:16,color:"#222",marginBottom:2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.title}),(0,b.jsx)("div",{style:{color:"#64748b",fontSize:13,marginBottom:2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.address}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,margin:"8px 0 2px 0"},children:[f,(0,b.jsx)("span",{style:{color:y,fontWeight:600,fontSize:12},children:x})]}),!G&&(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginTop:8},children:[(null===(o=e.agent)||void 0===o?void 0:o.photo)&&(0,b.jsx)(l.A,{src:e.agent.photo,size:28}),(0,b.jsxs)("span",{style:{fontSize:13,color:"#222",fontWeight:500},children:[null===(a=e.agent)||void 0===a?void 0:a.firstName," ",null===(n=e.agent)||void 0===n?void 0:n.lastName]}),(null===(s=e.agent)||void 0===s||null===(c=s.agency)||void 0===c?void 0:c.name)&&(0,b.jsxs)("span",{style:{fontSize:12,color:"#888",marginLeft:6},children:["(",e.agent.agency.name,")"]})]}),(0,b.jsx)("div",{style:{color:"#222",fontWeight:500,fontSize:17,margin:"2px 0 2px 0"},children:(m=e.price,m?m.toLocaleString("ru-RU").replace(/\u00A0/g," ").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1 ")+" \u0440\u0443\u0431":"")}),(0,b.jsxs)("div",{style:{display:"flex",gap:8,marginTop:8},children:[(0,b.jsx)(d.Ay,{shape:"circle",icon:(0,b.jsx)(N.A,{}),size:"middle",style:{background:"#f3f6fa",color:"#2563eb",border:"1.5px solid #dbeafe",...ve,marginLeft:0},onMouseOver:e=>{e.currentTarget.style.transform="scale(1.12)",e.currentTarget.style.boxShadow="0 2px 8px rgba(37,99,235,0.16)"},onMouseOut:e=>{e.currentTarget.style.transform="none",e.currentTarget.style.boxShadow="0 1px 4px rgba(37,99,235,0.08)"},onMouseDown:e=>{e.currentTarget.style.transform="scale(0.93)",e.currentTarget.style.boxShadow="0 1px 4px rgba(37,99,235,0.08)"},onMouseUp:e=>{e.currentTarget.style.transform="scale(1.12)",e.currentTarget.style.boxShadow="0 2px 8px rgba(37,99,235,0.16)"},onClick:t=>{t.stopPropagation(),ye(`/properties/${e.id}`)}}),(0,b.jsx)(d.Ay,{shape:"circle",icon:(0,b.jsx)(Z.A,{}),size:"middle",style:{background:"#f3f6fa",color:"#2563eb",border:"1.5px solid #dbeafe",...ve},onMouseOver:e=>{e.currentTarget.style.transform="scale(1.12)",e.currentTarget.style.boxShadow="0 2px 8px rgba(37,99,235,0.16)"},onMouseOut:e=>{e.currentTarget.style.transform="none",e.currentTarget.style.boxShadow="0 1px 4px rgba(37,99,235,0.08)"},onMouseDown:e=>{e.currentTarget.style.transform="scale(0.93)",e.currentTarget.style.boxShadow="0 1px 4px rgba(37,99,235,0.08)"},onMouseUp:e=>{e.currentTarget.style.transform="scale(1.12)",e.currentTarget.style.boxShadow="0 2px 8px rgba(37,99,235,0.16)"},onClick:t=>{t.stopPropagation(),xe(e.id)}}),!G&&(null===(u=e.agent)||void 0===u?void 0:u.phone)&&(0,b.jsx)(d.Ay,{shape:"circle",icon:(0,b.jsx)(F.A,{}),size:"middle",style:{background:"#f3f6fa",color:"#22c55e",border:"1.5px solid #bbf7d0",...ve},onMouseOver:e=>{e.currentTarget.style.transform="scale(1.12)",e.currentTarget.style.boxShadow="0 2px 8px rgba(37,99,235,0.16)"},onMouseOut:e=>{e.currentTarget.style.transform="none",e.currentTarget.style.boxShadow="0 1px 4px rgba(37,99,235,0.08)"},onMouseDown:e=>{e.currentTarget.style.transform="scale(0.93)",e.currentTarget.style.boxShadow="0 1px 4px rgba(37,99,235,0.08)"},onMouseUp:e=>{e.currentTarget.style.transform="scale(1.12)",e.currentTarget.style.boxShadow="0 2px 8px rgba(37,99,235,0.16)"},onClick:t=>{t.stopPropagation(),me({open:!0,agent:e.agent})}})]})]})]},e.id);var m}),(0,b.jsx)(O.A,{open:!!he,propertyId:he||void 0,onClose:()=>xe(null)}),!G&&(0,b.jsx)(o.A,{open:be.open,onCancel:()=>me({open:!1}),footer:null,title:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442 \u0430\u0433\u0435\u043d\u0442\u0430",destroyOnClose:!0,children:be.agent&&(0,b.jsxs)(a.A,{direction:"vertical",size:8,children:[(0,b.jsx)(l.A,{src:be.agent.photo,size:48}),(0,b.jsxs)(n.A.Text,{strong:!0,children:[be.agent.firstName," ",be.agent.lastName]}),(0,b.jsx)(n.A.Text,{type:"secondary",children:be.agent.phone})]})})]})]})}}}]);
//# sourceMappingURL=6506.5d233a2e.chunk.js.map