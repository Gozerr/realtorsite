"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6811],{1579:(e,t,i)=>{i.d(t,{IR:()=>o,Xc:()=>s,Xx:()=>a,qz:()=>r,vu:()=>l});var n=i(6291);const s=async e=>{const t=new URLSearchParams;e&&Object.entries(e).forEach(e=>{let[i,n]=e;void 0!==n&&null!==n&&""!==n&&t.append(i,n.toString())});const i=await n.Ay.get(`/api/properties?${t.toString()}`);return Array.isArray(i.data)?i.data:i.data&&Array.isArray(i.data.properties)?i.data.properties:[]},r=async e=>(await n.Ay.get(`/api/properties/${e}`)).data,o=async e=>s({agentId:e}),a=async()=>{const e=await n.Ay.get("/api/properties?sort=createdAt_desc&limit=10");return Array.isArray(e.data)?e.data:e.data&&Array.isArray(e.data.properties)?e.data.properties:[]},l=async(e,t,i)=>(await n.Ay.patch(`/api/properties/${e}/status`,{status:t},i?{headers:{Authorization:`Bearer ${i}`}}:void 0)).data},3560:(e,t,i)=>{i.d(t,{E:()=>a});var n=i(5043),s=i(6625),r=i(6291),o=i(2104);const a=()=>{const{user:e}=(0,s.As)(),[t,i]=(0,n.useState)({total:0,chat:0,support:0,property:0,system:0}),[a,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)(new Set),p=async()=>{if(null!==e&&void 0!==e&&e.id)try{l(!0);const t=await r.Ay.get(`/api/notifications/counters/${e.id}`);i(t.data)}catch(t){console.error("Error fetching notification counters:",t)}finally{l(!1)}},u=(e,t,n)=>{i(i=>{const s={...i};switch(e){case"chat":"increment"===t?s.chat++:"decrement"===t?s.chat=void 0!==n?Math.max(0,s.chat-n):Math.max(0,s.chat-1):"set"===t&&void 0!==n&&(s.chat=n);break;case"support":"increment"===t?s.support++:"decrement"===t?s.support=void 0!==n?Math.max(0,s.support-n):Math.max(0,s.support-1):"set"===t&&void 0!==n&&(s.support=n);break;case"property":"increment"===t?s.property++:"decrement"===t?s.property=void 0!==n?Math.max(0,s.property-n):Math.max(0,s.property-1):"set"===t&&void 0!==n&&(s.property=n);break;case"system":"increment"===t?s.system++:"decrement"===t?s.system=void 0!==n?Math.max(0,s.system-n):Math.max(0,s.system-1):"set"===t&&void 0!==n&&(s.system=n)}return s.total=s.chat+s.support+s.property+s.system,s})};return(0,n.useEffect)(()=>{p();const e=(0,o.io)("http://localhost:3001",{transports:["websocket"]});e.on("connect",()=>{console.log("Notifications hook connected to WebSocket")}),e.on("notification",e=>{"chat_message"!==e.type&&"chat"!==e.category||(console.log("New chat message notification received"),u("chat","increment")),"support_request"!==e.type&&"support"!==e.category||(console.log("New support request notification received"),u("support","increment")),"support_resolved"===e.type&&(console.log("Support request resolved notification received"),u("support","decrement")),"support_closed"===e.type&&(console.log("Support request closed notification received"),u("support","decrement"))});const t=setInterval(p,3e4);return()=>{e.disconnect(),clearInterval(t)}},[null===e||void 0===e?void 0:e.id]),{counters:t,loading:a,fetchCounters:p,markAsRead:async t=>{if(null!==e&&void 0!==e&&e.id)try{const i=t?`/api/notifications/mark-read/${e.id}/${t}`:`/api/notifications/mark-read/${e.id}`;await r.Ay.patch(i),await p()}catch(i){console.error("Error marking notifications as read:",i)}},updateCounters:u,markAsViewed:e=>{const t=new Set(c);e.forEach(e=>t.add(e)),d(t)},isViewed:e=>c.has(e),clearViewedNotifications:()=>{d(new Set)}}}},4501:(e,t,i)=>{i.d(t,{AI:()=>d,Aq:()=>l,R3:()=>r,WH:()=>s,dN:()=>c,gn:()=>a,qn:()=>p,uq:()=>o});var n=i(6291);const s=async e=>{if(e&&("support"===e.role||!e.agencyId))return null;return(await n.Ay.get("/api/agencies/my-agency")).data},r=async e=>(await n.Ay.post("/api/agencies/upload-documents",e,{headers:{"Content-Type":"multipart/form-data"}})).data,o=async e=>{const t=localStorage.getItem("token"),i=await fetch("/api/agencies/upload-logo",{method:"POST",headers:{Authorization:`Bearer ${t}`},body:e});if(!i.ok)throw new Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043b\u043e\u0433\u043e\u0442\u0438\u043f\u0430");return i.json()},a=async()=>(await n.Ay.get("/api/agencies/my-agency/agents")).data,l=async()=>(await n.Ay.get("/api/agencies/my-agency/managers")).data,c=async()=>(await n.Ay.get("/api/properties/agency")).data,d=async(e,t)=>(await n.Ay.patch(`/api/users/${e}/fire`,{reason:t})).data,p=async e=>(await n.Ay.patch(`/api/users/${e}/restore`)).data},6811:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ge});var n=i(7419),s=i(6051),r=i(3567),o=i(5964),a=i(6317),l=i(1645),c=i(1957),d=i(9126),p=i(7490),u=i(6651),h=i(5297),y=i(8964),g=i(5043),x=i(4563),m=i(6011),f=i(8818),v=i(3117),j=i(1795),A=i(7730),b=i(6879),w=i(9123),k=i(3722),S=i(4524),C=i(7990),z=i(6160),I=i(6881),N=i(7914),_=i(1283),E=i(6625),L=i(8105),R=i(4522),T=i(1686),$=i(5229),M=i(4786),W=i(8502),q=i(4113),F=i(9348),O=i(579);function H(){const{notifications:e,setNotifications:t,unreadCount:i,markAsRead:n,markAllAsRead:s}=(0,F.E)(),[o,a]=(0,g.useState)(!1),[l,c]=(0,g.useState)(!1),d=(0,_.Zp)(),u=(g.useContext(E.cy),e.filter(e=>"system"!==e.type)),h=e.filter(e=>"system"===e.type);(0,g.useEffect)(()=>{console.log("NotificationDropdown: unreadCount changed to",i)},[i]);const y=async e=>{a(!1),n(e),await(0,q.bA)(e),t(t=>t.map(t=>t.id===e?{...t,isNew:!1}:t)),d(`/notifications#notification-${e}`)},x=async()=>{s();for(const t of e.filter(e=>e.isNew))await(0,q.bA)(t.id);t(e=>e.map(e=>({...e,isNew:!1})))},f=(0,O.jsxs)(L.A,{defaultActiveKey:"main",style:{width:320},children:[(0,O.jsxs)(L.A.TabPane,{tab:"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435",children:[l?(0,O.jsx)(T.A,{}):(0,O.jsx)(R.A,{dataSource:u.slice(0,3),renderItem:e=>(0,O.jsx)(R.A.Item,{onClick:()=>y(e.id),style:{cursor:"pointer"},children:(0,O.jsx)(R.A.Item.Meta,{avatar:j(e.type),title:(0,O.jsxs)("span",{children:[e.title," ",e.isNew&&(0,O.jsx)(p.A,{color:"blue",text:"\u041d\u043e\u0432\u043e\u0435"})]}),description:(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{children:e.description}),(0,O.jsx)("div",{style:{fontSize:12,color:"#888"},children:A(e.createdAt)})]})})})}),u.some(e=>e.isNew)&&(0,O.jsx)("div",{style:{textAlign:"center",marginTop:8},children:(0,O.jsx)("a",{onClick:x,style:{color:"#6c63ff",cursor:"pointer",fontWeight:500},children:"\u041f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0432\u0441\u0435"})})]},"main"),(0,O.jsxs)(L.A.TabPane,{tab:"\u0421\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0435",children:[(0,O.jsx)(R.A,{dataSource:h.slice(0,3),renderItem:e=>(0,O.jsx)(R.A.Item,{onClick:()=>y(e.id),style:{cursor:"pointer"},children:(0,O.jsx)(R.A.Item.Meta,{avatar:j(e.type),title:(0,O.jsxs)("span",{children:[e.title," ",e.isNew&&(0,O.jsx)(p.A,{color:"blue",text:"\u041d\u043e\u0432\u043e\u0435"})]}),description:(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("div",{children:e.description}),(0,O.jsx)("div",{style:{fontSize:12,color:"#888"},children:A(e.createdAt)})]})})})}),h.some(e=>e.isNew)&&(0,O.jsx)("div",{style:{textAlign:"center",marginTop:8},children:(0,O.jsx)("a",{onClick:x,style:{color:"#6c63ff",cursor:"pointer",fontWeight:500},children:"\u041f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0432\u0441\u0435"})})]},"system"),(0,O.jsx)("div",{style:{textAlign:"center",marginTop:8},children:(0,O.jsx)("a",{href:"/notifications",children:"\u0412\u0441\u0435 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"})})]});function j(e){switch(e){case"clients":return(0,O.jsx)(k.A,{style:{color:"#e85aad"}});case"objects":return(0,O.jsx)(m.A,{style:{color:"#6c63ff"}});case"messages":return(0,O.jsx)(v.A,{style:{color:"#4caf50"}});case"reminder":return(0,O.jsx)($.A,{style:{color:"#ff9800"}});case"system":return(0,O.jsx)(M.A,{style:{color:"#2196f3"}});default:return(0,O.jsx)(M.A,{})}}function A(e){return new Date(e).toLocaleString("ru-RU",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"})}return(0,O.jsx)(r.A,{content:f,trigger:"click",open:o,onOpenChange:a,placement:"bottomRight",children:(0,O.jsx)(p.A,{count:i,children:(0,O.jsx)(W.A,{style:{fontSize:22,cursor:"pointer",transition:"color 0.2s"}})})})}var D=i(1368),B=i(1579),P=i(6291);var U=i(6909),V=i(2261),G=i(6399),K=i(1515),Q=i(6658),X=i(9073),Z=i(2019),J=i(4717),Y=i(3359),ee=i(4733),te=i(6237),ie=i(4501);const{Title:ne,Text:se}=h.A,re=e=>{let{open:t,onClose:i,onSuccess:r}=e;const[o,c]=(0,g.useState)(null),[d,p]=(0,g.useState)(!1),[u,h]=(0,g.useState)(!1),[y,x]=(0,g.useState)(!1),[m,f]=(0,g.useState)(!1),[v]=J.A.useForm(),j=(0,g.useContext)(E.cy);(0,g.useEffect)(()=>{var e,i;t&&("support"!==(null===j||void 0===j||null===(e=j.user)||void 0===e?void 0:e.role)&&null!==j&&void 0!==j&&null!==(i=j.user)&&void 0!==i&&i.agencyId?A():c(null))},[t,null===j||void 0===j?void 0:j.user]);const A=async()=>{try{p(!0);const e=await(0,ie.WH)(null===j||void 0===j?void 0:j.user);c(e),e&&v.setFieldsValue({name:e.name})}catch(e){Z.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430")}finally{p(!1)}};return(0,O.jsx)(U.A,{open:t,onCancel:i,title:"\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e\u043c",width:800,footer:null,destroyOnClose:!0,children:d?(0,O.jsx)(X.A,{loading:!0}):o?(0,O.jsx)("div",{children:(0,O.jsxs)(n.A,{gutter:24,children:[(0,O.jsx)(l.A,{xs:24,md:12,children:(0,O.jsx)(X.A,{title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0435",children:(0,O.jsxs)(s.A,{direction:"vertical",size:"large",style:{width:"100%"},children:[(0,O.jsxs)("div",{children:[(0,O.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,O.jsx)(se,{strong:!0,children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435:"}),!m&&(0,O.jsx)(a.Ay,{type:"text",icon:(0,O.jsx)(Y.A,{}),size:"small",onClick:()=>{f(!0)},children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})]}),m?(0,O.jsxs)(J.A,{form:v,layout:"vertical",children:[(0,O.jsx)(J.A.Item,{name:"name",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430"}],children:(0,O.jsx)(Q.A,{})}),(0,O.jsxs)(s.A,{children:[(0,O.jsx)(a.Ay,{type:"primary",size:"small",onClick:async()=>{try{await v.validateFields();Z.Ay.success("\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430"),f(!1),A(),null===r||void 0===r||r()}catch(e){Z.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438")}},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),(0,O.jsx)(a.Ay,{size:"small",onClick:()=>{f(!1),v.setFieldsValue({name:null===o||void 0===o?void 0:o.name})},children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]})]}):(0,O.jsx)(se,{children:o.name})]}),(0,O.jsxs)("div",{children:[(0,O.jsx)(se,{strong:!0,children:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430:"}),(0,O.jsx)("br",{}),o.logo?(0,O.jsx)("div",{style:{marginTop:8},children:(0,O.jsx)("img",{src:o.logo,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430",style:{maxWidth:200,maxHeight:100,objectFit:"contain",border:"1px solid #d9d9d9",borderRadius:8,padding:8}})}):(0,O.jsx)(se,{type:"secondary",children:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u043d\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d"}),(0,O.jsx)("div",{style:{marginTop:8},children:(0,O.jsx)(K.A,{beforeUpload:e=>((async e=>{if(o)try{x(!0);const t=new FormData;t.append("logo",e),await(0,ie.uq)(t),Z.Ay.success("\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d"),A(),null===r||void 0===r||r()}catch(t){Z.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043b\u043e\u0433\u043e\u0442\u0438\u043f\u0430")}finally{x(!1)}})(e),!1),accept:"image/*",disabled:y,showUploadList:!1,children:(0,O.jsx)(a.Ay,{icon:(0,O.jsx)(ee.A,{}),loading:y,size:"small",children:o.logo?"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043b\u043e\u0433\u043e\u0442\u0438\u043f":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043b\u043e\u0433\u043e\u0442\u0438\u043f"})})})]}),(0,O.jsxs)("div",{children:[(0,O.jsx)(se,{strong:!0,children:"\u0421\u0442\u0430\u0442\u0443\u0441 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438:"}),(0,O.jsx)("br",{}),o.verified?(0,O.jsx)(G.A,{icon:(0,O.jsx)(te.A,{}),color:"success",children:"\u041f\u0440\u043e\u0432\u0435\u0440\u0435\u043d\u043e"}):(0,O.jsx)(G.A,{icon:(0,O.jsx)($.A,{}),color:"warning",children:"\u041e\u0436\u0438\u0434\u0430\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438"})]}),!o.verified&&(0,O.jsx)(V.A,{message:"\u0410\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438",description:"\u041f\u043e\u0441\u043b\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442 \u0432\u0430\u0448\u0435 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e",type:"info",showIcon:!0})]})})}),(0,O.jsx)(l.A,{xs:24,md:12,children:(0,O.jsxs)(X.A,{title:"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430",children:[(0,O.jsx)(K.A,{multiple:!0,beforeUpload:()=>!1,onChange:e=>{let{fileList:t}=e;return(async e=>{if(o)try{h(!0);const t=new FormData;e.forEach(e=>{t.append("documents",e.originFileObj)}),t.append("agencyName",o.name),await(0,ie.R3)(t),Z.Ay.success("\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u044b"),A(),null===r||void 0===r||r()}catch(t){Z.Ay.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432")}finally{h(!1)}})(t)},accept:".pdf,.jpg,.jpeg,.png",disabled:u,children:(0,O.jsx)(a.Ay,{icon:(0,O.jsx)(ee.A,{}),loading:u,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b"})}),(0,O.jsx)("div",{style:{marginTop:16},children:(0,O.jsx)(se,{type:"secondary",children:"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u0444\u043e\u0440\u043c\u0430\u0442\u044b: PDF, JPG, PNG"})}),o.documents&&o.documents.length>0&&(0,O.jsxs)("div",{style:{marginTop:16},children:[(0,O.jsx)(se,{strong:!0,children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043d\u044b\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u044b:"}),(0,O.jsx)("ul",{children:o.documents.map((e,t)=>(0,O.jsx)("li",{children:(0,O.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:["\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442 ",t+1]})},t))})]})]})})]})}):(0,O.jsx)(V.A,{message:"\u0410\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e",description:"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u043f\u0440\u0438\u0432\u044f\u0437\u0430\u043d\u043d\u043e\u0433\u043e \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u0430",type:"error",showIcon:!0})})};var oe=i(2624),ae=i(3259);const le=()=>{const{isClientMode:e,toggleClientMode:t,shouldHideSensitiveData:i}=(0,ae.Q)(),{user:n}=(0,E.As)();return(()=>{if(null===n||void 0===n||!n.role)return!1;return!["support","admin"].includes(n.role)})()?(0,O.jsx)(u.A,{title:e?"\u041f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u0432 \u0440\u0435\u0436\u0438\u043c \u0430\u0433\u0435\u043d\u0442\u0430":"\u041f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u0432 \u0440\u0435\u0436\u0438\u043c \u043a\u043b\u0438\u0435\u043d\u0442\u0430",placement:"bottom",children:(0,O.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:38,height:38,borderRadius:"50%",background:"transparent",boxShadow:"none",border:"none",cursor:"pointer",transition:"all 0.2s",fontSize:15,fontWeight:600,color:e?"#ff9800":"#219653",userSelect:"none",margin:0,zIndex:1,padding:0},children:(0,O.jsx)(oe.A,{checked:e,onChange:t,checkedChildren:(0,O.jsx)(k.A,{style:{fontSize:18,verticalAlign:"middle",color:"#ff9800"}}),unCheckedChildren:(0,O.jsx)(f.A,{style:{fontSize:18,verticalAlign:"middle",color:"#219653"}}),size:"small",style:{background:e?"#ffe0b2":"#b7efc5",border:"none",boxShadow:"none",minWidth:38,height:22}})})}):null};var ce=i(6992),de=i(3560);const{Header:pe,Content:ue,Sider:he}=y.A,{Title:ye}=h.A,ge=()=>{var e,t,i,h,L,R,T,$;const[M,W]=(0,g.useState)(!1),q=(0,g.useContext)(E.cy),F=(0,_.Zp)(),U=(0,_.zy)(),[V,G]=(0,g.useState)(!1),[K,Q]=(0,g.useState)(!1),{theme:X,toggleTheme:Z}=(0,D.D)(),[J,Y]=(0,g.useState)(""),[ee,te]=(0,g.useState)([]),[ie,ne]=(0,g.useState)([]),[se,oe]=(0,g.useState)(!1),[ae,pe]=(0,g.useState)(!0),[ue,ye]=(0,g.useState)(!1),{counters:ge}=(0,de.E)(),[xe,me]=(0,g.useState)(window.innerWidth<992);(0,g.useEffect)(()=>{const e=()=>me(window.innerWidth<992);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const fe=[{key:"/",icon:(0,O.jsx)(x.A,{style:{color:"#296fff"}}),label:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f",path:"/"},{key:"/properties",icon:(0,O.jsx)(m.A,{style:{color:"#6c63ff"}}),label:"\u041e\u0431\u044a\u0435\u043a\u0442\u044b \u043d\u0435\u0434\u0432\u0438\u0436\u0438\u043c\u043e\u0441\u0442\u0438",path:"/properties"},{key:"/clients",icon:(0,O.jsx)(f.A,{style:{color:"#e85aad"}}),label:"\u041c\u043e\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u044b",path:"/clients"},{key:"/my-chats",icon:(0,O.jsx)(v.A,{style:{color:"#1976d2"}}),label:"\u041c\u043e\u0438 \u0447\u0430\u0442\u044b",path:"/my-chats",badge:ge.chat},{key:"/selection",icon:(0,O.jsx)(j.A,{style:{color:"#ff9800"}}),label:"\u041f\u043e\u0434\u0431\u043e\u0440",path:"/selection"},{key:"/notifications",icon:(0,O.jsx)(A.A,{style:{color:"#ff9800"}}),label:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f",path:"/notifications"},{key:"/education",icon:(0,O.jsx)(b.A,{style:{color:"#296fff"}}),label:"\u041e\u0431\u0443\u0447\u0435\u043d\u0438\u0435",path:"/education"},{key:"/agency",icon:(0,O.jsx)(f.A,{style:{color:"#52c41a"}}),label:"\u041c\u043e\u0451 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e",path:"/agency",role:"director"},{key:"/support",icon:(0,O.jsx)(w.A,{style:{color:"#ff4d4f"}}),label:"\u0421\u043b\u0443\u0436\u0431\u0430 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u043a\u0438",path:"/support",role:"support",badge:ge.support},{key:"/profile",icon:(0,O.jsx)(k.A,{style:{color:"#4caf50"}}),label:"\u041c\u043e\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c",path:"/profile"},{key:"/settings",icon:(0,O.jsx)(S.A,{style:{color:"#888"}}),label:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",path:"/settings"}];(0,g.useEffect)(()=>{!async function(){var e,t,i,n;let s=[];try{s=await(0,B.Xx)()}catch{}let r=[];try{r=await async function(){return(await P.Ay.get("/api/education")).data}()}catch{}const o=r.filter(e=>"event"===e.type||"webinar"===e.type),a=r.filter(e=>"course"===e.type),l=[...o.map(e=>({type:"\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u0435",label:e.title,value:e.title,path:"/education",tab:"events",description:e.description})),...a.map(e=>({type:"\u041a\u0443\u0440\u0441",label:e.title,value:e.title,path:"/education",tab:"courses",description:e.description})),{type:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c",label:(null===q||void 0===q||null===(e=q.user)||void 0===e?void 0:e.firstName)+" "+(null===q||void 0===q||null===(t=q.user)||void 0===t?void 0:t.lastName),value:(null===q||void 0===q||null===(i=q.user)||void 0===i?void 0:i.firstName)+" "+(null===q||void 0===q||null===(n=q.user)||void 0===n?void 0:n.lastName),path:"/profile",tab:"profile",description:""}],c=s.map(e=>({type:"\u041e\u0431\u044a\u0435\u043a\u0442",label:e.title,value:e.title,path:`/properties/${e.id}`,description:`${e.address} \u2014 ${e.description||""}`}));ne([...c,...l])}()},[q]),(0,g.useEffect)(()=>{const e=()=>{oe(window.scrollY>300)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,g.useEffect)(()=>{const e=()=>pe(!0),t=()=>pe(!1);return pe(window.navigator.onLine),window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}},[]);const ve=()=>{null===q||void 0===q||q.setAuthData(null,null),F("/login")},je=e=>{G(!1),"profile"===e&&F("/profile"),"settings"===e&&F("/settings"),"agency"===e&&Q(!0),"logout"===e&&ve()},Ae=(0,O.jsxs)("div",{style:{minWidth:200},children:[(0,O.jsxs)("div",{style:{padding:"12px 0",borderBottom:"1px solid var(--border-color)",marginBottom:8},children:[(0,O.jsx)("div",{style:{fontWeight:600,fontSize:14,color:"var(--text-primary)"},children:null!==q&&void 0!==q&&q.user?`${q.user.firstName} ${q.user.lastName}`:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c"}),(0,O.jsx)("div",{style:{color:"var(--text-secondary)",fontSize:12},children:(null===q||void 0===q||null===(e=q.user)||void 0===e?void 0:e.email)||""})]}),(0,O.jsx)("div",{style:{padding:"8px 0",cursor:"pointer",display:"flex",alignItems:"center"},onClick:()=>je("profile"),children:(0,O.jsxs)(u.A,{title:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c",children:[(0,O.jsx)(k.A,{style:{marginRight:8,color:"var(--success-color)"}})," \u041c\u043e\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c"]})}),"director"===(null===q||void 0===q||null===(t=q.user)||void 0===t?void 0:t.role)&&(0,O.jsx)("div",{style:{padding:"8px 0",cursor:"pointer",display:"flex",alignItems:"center"},onClick:()=>F("/agency"),children:(0,O.jsxs)(u.A,{title:"\u041c\u043e\u0451 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e",children:[(0,O.jsx)(C.A,{style:{marginRight:8,color:"#52c41a"}})," \u041c\u043e\u0451 \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e"]})}),(0,O.jsx)("div",{style:{padding:"8px 0",cursor:"pointer",display:"flex",alignItems:"center"},onClick:()=>je("settings"),children:(0,O.jsxs)(u.A,{title:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",children:[(0,O.jsx)(S.A,{style:{marginRight:8,color:"var(--text-secondary)"}})," \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"]})}),(0,O.jsxs)("div",{style:{padding:"8px 0",cursor:"pointer",color:"var(--error-color)",display:"flex",alignItems:"center",fontWeight:500,fontSize:15,transition:"background 0.2s"},onClick:()=>je("logout"),onMouseOver:e=>e.currentTarget.style.background="var(--border-light)",onMouseOut:e=>e.currentTarget.style.background="transparent",children:[(0,O.jsx)(u.A,{title:"\u0412\u044b\u0439\u0442\u0438",children:(0,O.jsx)(z.A,{style:{marginRight:8,color:"var(--error-color)",fontSize:18}})}),"\u0412\u044b\u0439\u0442\u0438"]})]});return(0,g.useEffect)(()=>{[{key:"/",tutorial:"sidebar-main"},{key:"/properties",tutorial:"sidebar-properties"},{key:"/clients",tutorial:"sidebar-clients"},{key:"/selection",tutorial:"sidebar-selection"},{key:"/notifications",tutorial:"sidebar-notifications"},{key:"/education",tutorial:"sidebar-education"},{key:"/profile",tutorial:"sidebar-profile"},{key:"/settings",tutorial:"sidebar-settings"}].forEach(e=>{let{key:t,tutorial:i}=e;const n=document.querySelector(`.ant-menu-item[data-menu-id='${t}']`);n&&n.setAttribute("data-tutorial",i)});const e=document.querySelector(".header-search input");e&&e.setAttribute("data-tutorial","header-search");const t=document.querySelector(".anticon-bell");t&&t.setAttribute("data-tutorial","header-notifications");const i=document.querySelector(".ant-btn .anticon-calendar");i&&i.parentElement&&i.parentElement.setAttribute("data-tutorial","header-calendar")},[]),(0,O.jsxs)(y.A,{style:{minHeight:"100vh"},children:[(0,O.jsxs)(he,{collapsible:!0,collapsed:M,onCollapse:W,width:240,className:ce.A.sidebar,breakpoint:"lg",trigger:null,style:{position:"fixed",left:0,top:0,height:"100vh",zIndex:1100},children:[(0,O.jsxs)("div",{style:{height:72,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:4,margin:"24px 0 32px 0"},children:[(0,O.jsx)("img",{src:"/logo192.png",alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f",style:{width:40,height:40,marginBottom:4}}),(0,O.jsx)("span",{style:{fontWeight:800,fontSize:20,letterSpacing:.5,color:"#296fff"},children:"\u0420\u0438\u044d\u043b\u0442\u0438\u041f\u0440\u043e"})]}),(0,O.jsx)(d.A,{mode:"inline",selectedKeys:[U.pathname],onClick:e=>{const t=fe.find(t=>t.key===e.key);t&&("agency-modal"===e.key?Q(!0):F(t.path))},style:{flex:1,borderRight:0},items:fe.filter(e=>{var t;return!e.role||e.role===(null===q||void 0===q||null===(t=q.user)||void 0===t?void 0:t.role)}).map(e=>({key:e.key,icon:e.icon,label:(0,O.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,O.jsx)("span",{children:e.label}),e.badge&&e.badge>0&&(0,O.jsx)(p.A,{count:e.badge,size:"small",style:{backgroundColor:"#ff4d4f",fontSize:"10px",fontWeight:"bold"}})]}),"data-menu-id":e.key}))}),(0,O.jsx)("div",{style:{marginTop:"auto",padding:0},children:(0,O.jsxs)("div",{onClick:ve,style:{width:"100%",background:"var(--surface-color)",border:"none",borderRadius:0,fontSize:15,fontWeight:400,color:"var(--text-primary)",display:"flex",alignItems:"center",gap:8,cursor:"pointer",transition:"background 0.2s",height:44,marginBottom:0,paddingLeft:24,paddingRight:16,marginTop:0},onMouseOver:e=>e.currentTarget.style.background="var(--border-light)",onMouseOut:e=>e.currentTarget.style.background="var(--surface-color)",children:[(0,O.jsx)(u.A,{title:"\u0412\u044b\u0439\u0442\u0438",children:(0,O.jsx)(z.A,{style:{fontSize:18,marginRight:12,color:"var(--error-color)"}})}),(0,O.jsx)("span",{style:{fontSize:15,fontWeight:400},children:"\u0412\u044b\u0439\u0442\u0438"})]})})]}),(0,O.jsxs)(y.A,{style:{marginLeft:240},children:[(0,O.jsx)(y.A.Header,{className:ce.A.headerFixed+" site-layout-background",style:{padding:xe?"0 8px":"0 24px",height:xe?56:64,boxShadow:"0 2px 8px rgba(40,60,90,0.10)",borderBottom:"1px solid #e6eaf1",display:"flex",alignItems:"center",position:"fixed",top:0,left:240,width:"calc(100vw - 240px)",zIndex:1100,transition:"left 0.2s, width 0.2s"},children:(0,O.jsxs)(n.A,{justify:"space-between",align:"middle",style:{width:"100%"},children:[(0,O.jsx)(l.A,{flex:"1 1 0%",style:{maxWidth:700,marginRight:32},children:(0,O.jsx)(c.A,{value:J,options:ee,style:{width:"100%",fontSize:18},onSearch:e=>{if(Y(e),!e)return void te([]);const t=ie.filter(t=>t.label.toLowerCase().includes(e.toLowerCase())||t.description&&t.description.toLowerCase().includes(e.toLowerCase()));te(t.map(e=>({value:e.value,label:(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,O.jsxs)("span",{children:[(0,O.jsx)("b",{children:e.label})," ",(0,O.jsxs)("span",{style:{color:"#888",fontSize:12},children:["(",e.type,")"]})]}),(0,O.jsx)("span",{style:{color:"#888",fontSize:12},children:e.description})]}),item:e})))},onSelect:(e,t)=>{const i=t.item;i.path&&(F(i.path),i.tab&&localStorage.setItem("search_tab",i.tab)),Y(""),te([])},placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u0441\u0430\u0439\u0442\u0443...",allowClear:!0,filterOption:!1,size:"large",className:"header-search"})}),(0,O.jsx)(l.A,{flex:"none",children:(0,O.jsxs)(s.A,{size:20,align:"center",style:{height:48,marginRight:"30px"},children:[(0,O.jsx)("div",{style:{width:38,height:38,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,O.jsx)(H,{})}),(0,O.jsx)("div",{style:{width:38,height:38,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,O.jsx)(le,{})}),(0,O.jsx)("div",{style:{width:38,height:38,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,O.jsx)(_.N_,{to:"/calendar",children:(0,O.jsx)(u.A,{title:"\u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c",children:(0,O.jsx)(a.Ay,{type:"text",icon:(0,O.jsx)(I.A,{style:{fontSize:24,color:"#1976d2",cursor:"pointer",verticalAlign:"middle"}}),onClick:()=>F("/calendar"),style:{width:38,height:38,display:"flex",alignItems:"center",justifyContent:"center",padding:0}})})})}),(0,O.jsx)("div",{style:{width:38,height:38,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,O.jsx)(r.A,{content:Ae,trigger:"click",open:V,onOpenChange:G,placement:"bottomRight",children:(0,O.jsx)(o.A,{src:(null===q||void 0===q||null===(i=q.user)||void 0===i?void 0:i.photo)||(null===q||void 0===q||null===(h=q.user)||void 0===h?void 0:h.avatar)||void 0,icon:(0,O.jsx)(k.A,{}),style:{cursor:"pointer",width:38,height:38,boxShadow:"0 2px 8px var(--shadow-light)",transition:"box-shadow 0.2s",background:"#e9f0fb",display:"flex",alignItems:"center",justifyContent:"center"},children:null!==q&&void 0!==q&&null!==(L=q.user)&&void 0!==L&&L.photo||null!==q&&void 0!==q&&null!==(R=q.user)&&void 0!==R&&R.avatar||null===q||void 0===q||null===(T=q.user)||void 0===T||!T.firstName||null===q||void 0===q||null===($=q.user)||void 0===$||!$.lastName?null:`${q.user.firstName[0]}${q.user.lastName[0]}`})})})]})})]})}),(0,O.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:360,background:"var(--background-color)",marginLeft:0,paddingTop:xe?56:64,marginRight:0},children:(0,O.jsx)(_.sv,{})})]}),(0,O.jsx)(u.A,{title:"\u041d\u0430\u0432\u0435\u0440\u0445",children:(0,O.jsx)(a.Ay,{type:"primary",shape:"circle",icon:(0,O.jsx)(N.A,{}),size:"large",onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},style:{position:"fixed",right:24,bottom:xe?80:40,zIndex:2e3,boxShadow:"0 4px 16px rgba(0,0,0,0.12)",display:se?"block":"none",background:"#296fff",color:"#fff",border:"none",transition:"bottom 0.3s"}})}),(0,O.jsx)(re,{open:K,onClose:()=>Q(!1),onSuccess:()=>Q(!1)})]})}},6992:(e,t,i)=>{i.d(t,{A:()=>n});const n={sidebar:"AppLayout_sidebar__5aCtG","ant-menu":"AppLayout_ant-menu__NxR5Q","ant-menu-item":"AppLayout_ant-menu-item__IAwYZ","ant-menu-item-selected":"AppLayout_ant-menu-item-selected__zCOoC",tabContent:"AppLayout_tabContent__+q2OJ",glassCardAppear:"AppLayout_glassCardAppear__EKc28",headerFixed:"AppLayout_headerFixed__yblpH",tutorialMenuHighlight:"AppLayout_tutorialMenuHighlight__U4OEQ"}}}]);
//# sourceMappingURL=6811.8a816e1c.chunk.js.map